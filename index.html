<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SecureCheck - Protocol Checklist</title>

    <!-- Performance: Preconnect to Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Performance: Load Google Fonts via Link (Optimized Weights - Adjust if needed) -->
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700&display=swap" rel="stylesheet">

    <!-- Other CSS Libraries -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/boxicons@2.1.4/css/boxicons.min.css">

    <style>
        :root {
            --primary: #8b5cf6;
            --primary-dark: #7c3aed;
            --primary-light: #a78bfa;
            --primary-alpha: rgba(139, 92, 246, 0.2);
            --secondary: #10b981;
            --secondary-alpha: rgba(16, 185, 129, 0.2);
            --dark: #0f172a;
            --darker: #020617;
            --light: #f8fafc;
            --neutral: #64748b;
            --glass-light: rgba(255, 255, 255, 0.05);
            --glass-dark: rgba(0, 0, 0, 0.2);
            --card-bg: rgba(15, 23, 42, 0.7);
            --sidebar-bg: rgba(2, 6, 23, 0.85);
            --glow: 0 0 15px rgba(139, 92, 246, 0.6);
            --transition-smooth: 0.5s cubic-bezier(0.33, 1, 0.68, 1);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Manrope', system-ui, -apple-system, sans-serif; }
        html { scroll-behavior: smooth; }
        body { background: var(--darker); color: var(--light); min-height: 100vh; overflow-x: hidden; background-image: radial-gradient(circle at 10% 20%, rgba(139, 92, 246, 0.05) 0%, transparent 20%), radial-gradient(circle at 90% 80%, rgba(16, 185, 129, 0.05) 0%, transparent 20%), radial-gradient(circle at 50% 50%, rgba(15, 23, 42, 0.8) 0%, var(--darker) 100%); }

        /* Glass Morphism Base Styles - Includes backdrop-filter */
        .glass, .glass-dark, .glass-card, .glass-inset {
            background: rgba(15, 23, 42, 0.6); /* Default light glass bg */
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }
        .glass-dark { background: rgba(2, 6, 23, 0.8); box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3); border-color: rgba(255, 255, 255, 0.03); }
        .glass-card { border-radius: 16px; }
        .glass-inset { background: rgba(2, 6, 23, 0.5); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border-radius: 16px; box-shadow: inset 2px 2px 5px rgba(0, 0, 0, 0.5), inset -2px -2px 5px rgba(255, 255, 255, 0.05); border-color: rgba(255, 255, 255, 0.03); }

        /* Performance: Disable expensive backdrop-filter on touch/mobile */
        @media (hover: none) and (pointer: coarse), (max-width: 768px) {
             .glass, .glass-dark, .glass-card, .glass-inset {
                 backdrop-filter: none !important;
                 -webkit-backdrop-filter: none !important;
                 /* Optional: Increase opacity slightly when blur is off */
                 /* background: rgba(15, 23, 42, 0.8); */
             }
             .glass-dark { /* background: rgba(2, 6, 23, 0.9); */ }
             .glass-inset { /* background: rgba(2, 6, 23, 0.6); */ }
        }

        .glass-card:hover { box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3), 0 0 20px rgba(139, 92, 246, 0.2); transform: translateY(-3px); }
        .animated-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; overflow: hidden; }
        .floating-particle { position: absolute; background: var(--primary-alpha); border-radius: 50%; opacity: 0; animation: float 20s infinite linear; }
        @keyframes float { 0% { opacity: 0; transform: translateY(0) translateX(0) rotate(0deg); } 10% { opacity: 0.4; } 90% { opacity: 0.4; } 100% { opacity: 0; transform: translateY(calc(-100vh - 100px)) translateX(calc(100vw * var(--x-travel))) rotate(360deg); } }
        .sidebar { background: var(--sidebar-bg); height: 100vh; position: fixed; top: 0; left: 0; padding: 2rem 1.5rem; width: 300px; z-index: 50; transition: transform 0.6s cubic-bezier(0.22, 1, 0.36, 1); border-right: 1px solid rgba(255, 255, 255, 0.03); display: flex; flex-direction: column; overflow-y: hidden; }
        .content-area { margin-left: 300px; padding: 2rem; min-height: 100vh; transition: margin-left 0.6s cubic-bezier(0.22, 1, 0.36, 1); position: relative; z-index: 1; }
        @media (max-width: 1024px) { .sidebar { transform: translateX(-100%); } .sidebar.open { transform: translateX(0); } .content-area { margin-left: 0; width: 100%; } }
        @media (max-width: 768px) { .content-area { padding: 1.5rem 1rem; } header h1 { font-size: 1.75rem !important; } .card-header { flex-direction: column !important; align-items: flex-start !important; padding: 1.5rem 1rem !important; } .card-header > div:last-child { width: 100%; justify-content: space-between; margin-top: 1rem; } .progress-container { width: 100% !important; } #protocolCards { min-height: 200px; } }

        /* Removed will-change from protocol-card */
        .protocol-card { transition: opacity 0.6s cubic-bezier(0.22, 1, 0.36, 1), transform 0.6s cubic-bezier(0.22, 1, 0.36, 1), box-shadow 0.4s ease; transform-style: preserve-3d; perspective: 1000px; overflow: hidden; transform: translateZ(0); backface-visibility: hidden; opacity: 0; }
        .card-header { cursor: pointer; transition: background-color 0.4s ease; }
        /* Removed will-change from card-content */
        .card-content { max-height: 0; overflow: hidden; padding: 0 20px 0 20px; transition: max-height 0.6s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.4s cubic-bezier(0.16, 1, 0.3, 1), padding 0.6s cubic-bezier(0.16, 1, 0.3, 1), transform 0.6s cubic-bezier(0.16, 1, 0.3, 1); opacity: 0; visibility: hidden; transform: translateY(10px); transform-origin: top; }
        .protocol-card.expanded .card-content { max-height: 2000px; opacity: 1; visibility: visible; padding: 0 20px 20px 20px; transform: translateY(0); }
        .toggle-container { position: relative; width: 50px; height: 26px; flex-shrink: 0; min-width: 50px; } .toggle-input { opacity: 0; width: 0; height: 0; } .toggle-slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(15, 23, 42, 0.7); transition: all 0.4s cubic-bezier(0.22, 1, 0.36, 1); border-radius: 34px; box-shadow: inset 2px 2px 4px var(--glass-dark), inset -2px -2px 4px var(--glass-light); overflow: hidden; } .toggle-slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 4px; bottom: 4px; background: var(--light); transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1); border-radius: 50%; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3); z-index: 2; } .toggle-slider::after { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, var(--primary-dark) 0%, var(--primary) 100%); transition: all 0.4s cubic-bezier(0.22, 1, 0.36, 1); opacity: 0; } .toggle-input:checked + .toggle-slider::after { left: 0; opacity: 1; } .toggle-input:checked + .toggle-slider:before { transform: translateX(24px); background: white; } .toggle-input:checked + .toggle-slider { box-shadow: 0 0 8px var(--primary-alpha); }
        .progress-container { width: 100%; height: 12px; background: rgba(15, 23, 42, 0.5); border-radius: 10px; box-shadow: inset 2px 2px 4px var(--glass-dark), inset -2px -2px 4px var(--glass-light); margin: 1rem 0; overflow: hidden; position: relative; } .progress-container::after { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(90deg, transparent 0%, rgba(255, 255, 255, 0.1) 50%, transparent 100%); opacity: 0.5; } .progress-bar { height: 100%; background: linear-gradient(90deg, var(--primary-dark), var(--primary), var(--primary-light)); border-radius: 10px; transition: width 1s cubic-bezier(0.22, 1, 0.36, 1); position: relative; overflow: hidden; width: 0; } .progress-bar::after { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent 0%, rgba(255, 255, 255, 0.2) 50%, transparent 100%); animation: progressShine 2s infinite; } @keyframes progressShine { to { left: 100%; } }
        .category-badge { display: inline-block; padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.75rem; font-weight: 600; letter-spacing: 0.05em; text-transform: uppercase; background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); box-shadow: 0 2px 10px rgba(139, 92, 246, 0.3); position: relative; overflow: hidden; color: white; } .category-badge::after { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 0.3) 50%, rgba(255, 255, 255, 0) 100%); transform: skewX(-25deg); transition: all 0.8s ease; } @keyframes shine { 0% { left: -100%; } 100% { left: 100%; } }
        .category-filters { display: flex; gap: 0.75rem; flex-wrap: wrap; }
        /* Removed will-change from category-filter */
        .category-filter { padding: 0.4rem 1rem; border-radius: 9999px; cursor: pointer; transition: all 0.4s cubic-bezier(0.22, 1, 0.36, 1); background: rgba(15, 23, 42, 0.3); border: 1px solid rgba(255, 255, 255, 0.05); position: relative; overflow: hidden; font-weight: 500; font-size: 0.85rem; }
        .category-filter:hover { background: rgba(15, 23, 42, 0.5); transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); }
        .category-filter.active { background: var(--active-filter-bg, var(--primary)); box-shadow: 0 0 20px rgba(139, 92, 246, 0.3); transform: translateY(-2px); color: white; }
        .category-filter.active::after { content: ''; position: absolute; top: 0; left: -100%; width: 200%; height: 100%; background: linear-gradient(90deg, transparent 0%, rgba(255, 255, 255, 0.2) 50%, transparent 100%); animation: shine 3s infinite; }
        .fade-in { animation: fadeIn 0.8s cubic-bezier(0.22, 1, 0.36, 1) forwards; opacity: 0; } @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } } .slide-in-right { animation: slideInRight 0.8s cubic-bezier(0.22, 1, 0.36, 1) forwards; } @keyframes slideInRight { from { transform: translateX(30px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        ::-webkit-scrollbar { width: 8px; } ::-webkit-scrollbar-track { background: rgba(15, 23, 42, 0.2); border-radius: 10px; } ::-webkit-scrollbar-thumb { background: var(--primary-dark); border-radius: 10px; transition: all 0.3s ease; } ::-webkit-scrollbar-thumb:hover { background: var(--primary); box-shadow: 0 0 10px var(--primary); }
        .section-animate { transform: translateY(20px); transition: opacity 0.6s cubic-bezier(0.22, 1, 0.36, 1), transform 0.6s cubic-bezier(0.22, 1, 0.36, 1); } .section-animate.visible { opacity: 1; transform: translateY(0); } .protocol-card.section-animate { opacity: 0; } .protocol-card.section-animate.visible { opacity: 1; }
        /* Removed will-change from list-item-animate */
        .list-item-animate { opacity: 0; transform: translateX(20px); transition: all 0.5s cubic-bezier(0.22, 1, 0.36, 1); }
        .list-item-no-checkbox { margin-left: 0.5rem; padding-left: 0; }
        .search-container { position: relative; margin-bottom: 1.25rem; } .search-input { width: 100%; padding: 0.75rem 1rem 0.75rem 3rem; border-radius: 12px; background: rgba(15, 23, 42, 0.3); border: 1px solid rgba(255, 255, 255, 0.05); color: var(--light); transition: all 0.4s cubic-bezier(0.22, 1, 0.36, 1); backdrop-filter: blur(4px); -webkit-backdrop-filter: blur(4px); } .search-input:focus { outline: none; box-shadow: 0 0 0 2px var(--primary-alpha), 0 0 15px rgba(139, 92, 246, 0.3); background: rgba(15, 23, 42, 0.5); border-color: rgba(139, 92, 246, 0.3); } .search-icon { position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); color: var(--neutral); transition: color 0.3s ease; } .search-input:focus + .search-icon { color: var(--primary); }
        .nav-links { flex: 1; overflow-y: auto; padding-right: 5px; margin-bottom: 1rem; max-height: calc(100vh - 130px); }
        .protocol-nav-item { position: relative; overflow: hidden; padding-left: 1rem; margin-bottom: 0.6rem; border-radius: 12px; transition: all 0.4s cubic-bezier(0.22, 1, 0.36, 1); /* Removed will-change */ }
        .protocol-nav-item::before { content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 4px; background: var(--nav-item-color, var(--primary)); border-top-left-radius: inherit; border-bottom-left-radius: inherit; }
        .protocol-nav-item:hover { transform: translateX(5px); background: rgba(15, 23, 42, 0.8) !important; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1), 0 0 5px rgba(139, 92, 246, 0.2); }
        .protocol-nav-item.hidden { display: none; } .protocol-nav-item > div { }
        #mainCategoryFiltersContainer { margin-bottom: 1.5rem; md:margin-bottom: 2rem; }
        .category-indicator { position: absolute; left: 0; top: 0; bottom: 0; width: 4px; border-top-left-radius: 16px; border-bottom-left-radius: 16px; }
        .expand-btn { position: relative; overflow: hidden; transition: all 0.4s cubic-bezier(0.22, 1, 0.36, 1); } .expand-btn:hover { box-shadow: 0 0 15px rgba(139, 92, 246, 0.3); transform: translateY(-2px); } .expand-btn::after { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(circle, rgba(139, 92, 246, 0.2) 0%, transparent 70%); opacity: 0; transition: opacity 0.3s ease; } .expand-btn:hover::after { opacity: 1; } .expand-btn i { transition: transform 0.5s cubic-bezier(0.22, 1, 0.36, 1); }
        .no-results { text-align: center; padding: 3rem; background: rgba(15, 23, 42, 0.5); border-radius: 1rem; margin: 2rem 0; backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.03); box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); transition: all 0.5s cubic-bezier(0.22, 1, 0.36, 1); } .no-results:hover { box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2), 0 0 20px rgba(139, 92, 246, 0.1); transform: translateY(-5px); }
        .logo { position: relative; display: inline-block; } .logo::after { content: ''; position: absolute; left: 0; right: 0; bottom: -3px; height: 2px; background: linear-gradient(90deg, var(--primary-dark), var(--primary), var(--primary-dark)); transform: scaleX(0); transform-origin: left; transition: transform 0.6s cubic-bezier(0.22, 1, 0.36, 1); } .logo:hover::after { transform: scaleX(1); }
        .menu-toggle { transition: all 0.4s cubic-bezier(0.22, 1, 0.36, 1); z-index: 60; } .menu-toggle:hover { transform: rotate(90deg); box-shadow: 0 0 15px rgba(139, 92, 246, 0.3); }
        /* Removed will-change from content-section */
        .content-section { transition: opacity 0.5s cubic-bezier(0.22, 1, 0.36, 1), transform 0.5s cubic-bezier(0.22, 1, 0.36, 1); transform: translateY(20px); opacity: 0; }
        .protocol-card.expanded .content-section { transform: translateY(0); opacity: 1; }
        .completion-percentage { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 0.75rem; font-weight: 600; color: white; text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5); opacity: 0; transition: opacity 0.3s ease; pointer-events: none; } .progress-container:hover .completion-percentage { opacity: 1; }
        .checkmark-animate { transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1); display: inline-block; overflow-wrap: break-word; word-wrap: break-word; vertical-align: top; margin-top: 0.1rem; } .toggle-input:checked ~ .checkmark-animate { transform: scale(1.1) rotate(5deg); }
        li.list-item-animate { transition: background 0.3s ease, transform 0.3s ease, opacity 0.5s cubic-bezier(0.22, 1, 0.36, 1), transform 0.5s cubic-bezier(0.22, 1, 0.36, 1); border-radius: 8px; padding: 0.5rem; align-items: flex-start; } li.list-item-animate:hover:not(.list-item-no-checkbox-container) { background: rgba(255, 255, 255, 0.05); transform: translateX(5px) translateY(0); } li.list-item-no-checkbox-container:hover { background: transparent; transform: none; }
        .protocol-section h2 { margin-bottom: 0.75rem; font-size: 1.1rem; }
        .pagination-container { display: flex; justify-content: center; align-items: center; margin-top: 2rem; gap: 0.5rem; flex-wrap: wrap; } .pagination-btn { display: flex; align-items: center; justify-content: center; width: 40px; height: 40px; border-radius: 50%; background: rgba(15, 23, 42, 0.3); border: 1px solid rgba(255, 255, 255, 0.05); color: var(--light); font-weight: 500; cursor: pointer; transition: all 0.3s ease; } .pagination-btn:hover:not(:disabled) { background: rgba(15, 23, 42, 0.5); box-shadow: 0 0 15px rgba(139, 92, 246, 0.2); transform: translateY(-2px); } .pagination-btn.active { background: var(--primary); color: white; font-weight: 600; box-shadow: 0 0 20px rgba(139, 92, 246, 0.3); } .pagination-btn:disabled { opacity: 0.5; cursor: not-allowed; } .pagination-ellipsis { display: flex; align-items: center; justify-content: center; width: 40px; height: 40px; color: var(--neutral); }
        .port-badge { font-family: 'Courier New', monospace; background: rgba(15, 23, 42, 0.5); padding: 0.2rem 0.5rem; border-radius: 4px; font-size: 0.8rem; margin-left: 0.5rem; border: 1px solid rgba(255, 255, 255, 0.1); display: inline-block; }
        .loading-indicator { display: flex; justify-content: center; align-items: center; padding: 2rem; font-weight: 500; color: var(--neutral); } .loading-spinner { width: 24px; height: 24px; border: 3px solid rgba(139, 92, 246, 0.2); border-radius: 50%; border-top-color: var(--primary); animation: spin 1s linear infinite; margin-right: 10px; } @keyframes spin { to { transform: rotate(360deg); } }
        @media (max-width: 640px) { .category-filter { padding: 0.3rem 0.8rem; font-size: 0.75rem; } .category-badge { font-size: 0.65rem; padding: 0.2rem 0.6rem; } .progress-container { height: 10px; } .card-header { padding: 1.2rem 1rem !important; } .card-header h2 { font-size: 1.5rem !important; } .protocol-card .grid { grid-template-columns: 1fr !important; display: block !important; } .glass-inset { margin-bottom: 1rem; } .toggle-container { min-width: 40px; width: 40px; height: 22px; } .toggle-slider:before { height: 14px; width: 14px; } .toggle-input:checked + .toggle-slider:before { transform: translateX(18px); } .nav-links { max-height: calc(100vh - 110px); } .list-item-no-checkbox { margin-left: 0.25rem; } .protocol-nav-item { padding-left: 0.75rem !important; padding-top: 0.75rem !important; padding-bottom: 0.75rem !important; padding-right: 0.75rem !important; } }
        @media (max-width: 768px) { .card-content { transition-duration: 0.4s; padding: 0 15px 0 15px; } .protocol-card.expanded .card-content { padding: 0 15px 15px 15px; } .content-section { transition-delay: 0.05s !important; } }
        @media (max-width: 640px) { li.list-item-animate { padding: 0.75rem 0.5rem; margin-bottom: 0.75rem; } .pagination-btn { width: 36px; height: 36px; } .expand-btn { padding: 0.75rem !important; } }
        @media (hover: none) and (pointer: coarse) { .glass-card:hover { transform: none; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2); } .category-filter:hover { transform: none; box-shadow: none; } .category-badge:hover::after, .card-header:hover .category-badge::after { animation: none; } .category-filter.active:hover::after { animation: none; } .expand-btn:hover { transform: none; box-shadow: none; } .expand-btn:hover::after { opacity: 0; } .pagination-btn:hover:not(:disabled) { transform: none; box-shadow: none; } .protocol-nav-item:hover { transform: none; box-shadow: none; background: rgba(15, 23, 42, 0.8) !important; } .no-results:hover { transform: none; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); } li.list-item-animate:hover { transform: translateX(0) translateY(0); background: transparent; } }
        .command-inline { font-family: 'Courier New', Courier, monospace; background-color: rgba(2, 6, 23, 0.7); color: var(--primary-light); padding: 0.15em 0.5em; border-radius: 5px; font-size: 0.875em; border: 1px solid rgba(255, 255, 255, 0.08); display: inline-block; vertical-align: baseline; word-break: break-word; margin: 0 0.1em; box-shadow: inset 1px 1px 3px rgba(0, 0, 0, 0.3); }
    </style>
</head>
<body>
    <!-- Background Animation Elements -->
    <div class="animated-bg" id="animatedBg"></div>

    <!-- Mobile menu toggle -->
    <button id="menuToggle" class="fixed top-4 left-4 z-50 lg:hidden menu-toggle p-2 glass-dark rounded-full text-white focus:outline-none">
        <i class="bx bx-menu text-2xl"></i>
    </button>

    <!-- Sidebar -->
    <aside class="sidebar glass-dark" id="sidebar">
        <!-- Header -->
        <div class="flex flex-col mb-8 flex-shrink-0">
            <div class="flex items-center justify-between">
                <h1 class="text-2xl font-bold tracking-tight logo">
                    <span class="text-primary">Secure</span>Check
                </h1>
                <button id="mobileClose" class="lg:hidden p-1 rounded-full hover:bg-gray-700 focus:outline-none text-white">
                    <i class="bx bx-x text-2xl"></i>
                </button>
            </div>
             <div class="flex items-center mt-2">
                 <p class="text-xs text-gray-400 tracking-wide relative group">
                    <span class="text-primary">◈</span> Created by <span class="underline cursor-pointer text-gray-300 hover:text-primary transition-colors duration-300">Aditya Singh</span>
                    <span class="absolute bottom-full left-0 mb-2 w-48 p-2 bg-gray-800 rounded-md shadow-lg text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none z-10">
                        https://www.youtube.com/watch?v=dQw4w9WgXcQ<br>© 2025 All Rights Reserved
                    </span>
                </p>
            </div>
        </div>
        <!-- Search -->
        <div class="search-container flex-shrink-0">
            <input type="text" id="search" class="search-input" placeholder="Search protocols or ports...">
            <i class="bx bx-search search-icon"></i>
        </div>
        <!-- Protocols List -->
        <div class="protocol-section flex-grow flex flex-col min-h-0">
            <h2 class="text-lg font-semibold mb-2 text-neutral-300 flex-shrink-0">Protocols</h2>
            <div class="nav-links space-y-2" id="protocolNav">
                <!-- Protocol nav items rendered here -->
            </div>
        </div>
    </aside>

    <!-- Main content -->
    <main class="content-area" id="mainContent">
        <header class="mb-6 md:mb-10 fade-in" style="animation-delay: 0.1s;">
            <h1 class="text-3xl md:text-4xl font-bold mb-2">Protocol Security Checklist</h1>
            <p class="text-gray-400">Track testing procedures and discover vulnerabilities & tools for network protocols.</p>
        </header>

        <!-- Category Filters in Main Content -->
        <div id="mainCategoryFiltersContainer" class="mb-6 md:mb-8">
             <h2 class="text-lg font-semibold mb-3 text-neutral-300">Filter by Category:</h2>
             <div class="category-filters" id="categoryFilters">
                <button class="category-filter active" data-category="all">All</button>
                <!-- Category filters will be rendered here by JS -->
            </div>
        </div>

        <!-- Loading Indicator -->
        <div class="loading-indicator col-span-full" id="loadingIndicator" style="display: none;">
           <div class="loading-spinner"></div>
           Loading protocols...
       </div>

        <!-- Protocol Cards Grid -->
        <div class="grid grid-cols-1 gap-6" id="protocolCards">
            <!-- Protocol Cards will be rendered here -->
        </div>

        <!-- Pagination -->
        <div class="pagination-container" id="paginationContainer">
             <!-- Pagination will be rendered here -->
        </div>
    </main>

    <script>
        // --- DATA (Populate with your complete protocol list) ---
        const protocolData = [
             {
                id: 'ftp',
                name: 'FTP',
                port: 21,
                category: 'file',
                description: 'File Transfer Protocol used for transferring files between client and server.',
                vulnerabilities: [
                    'Anonymous access',
                    'Brute force attacks',
                    'Clear-text credentials',
                    'FTP bounce attacks',
                    'Directory traversal',
                    'Outdated FTP servers'
                ],
                testing: [
                    'Check for anonymous login: `ftp target.com` (user: anonymous, pass: anonymous)',
                    'Attempt brute force: `hydra -L users.txt -P pass.txt ftp://target.com`',
                    'Check for FTP bounce attack: `nmap -b anonymous:anonymous@target.com otherserver.com`',
                    'Look for sensitive data in FTP directories',
                    'Test for directory traversal using "../" sequences'
                ],
                tools: [
                    'Nmap FTP scripts',
                    'Hydra',
                    'Medusa',
                    'Metasploit FTP auxiliary modules',
                    'FileZilla (for manual testing)'
                ]
            },
            {
                id: 'ssh',
                name: 'SSH',
                port: 22,
                category: 'remote',
                description: 'Secure Shell protocol used for secure remote login and other secure network services.',
                vulnerabilities: [
                    'Weak passwords',
                    'Outdated SSH versions (v1, older v2)',
                    'Misconfigured permissions',
                    'Authentication bypass CVEs',
                    'SSH user enumeration timing attacks',
                    'Default or backdoor credentials'
                ],
                testing: [
                    'Enumerate version: `nmap -sV -p 22 target.com`',
                    'Check for weak ciphers: `nmap --script ssh2-enum-algos target.com`',
                    'Attempt brute force: `hydra -L users.txt -P pass.txt ssh://target.com`',
                    'Test for user enumeration: `metasploit auxiliary/scanner/ssh/ssh_enumusers`',
                    'Check for authorized_keys file permissions',
                    'Look for CVEs for specific SSH versions'
                ],
                tools: [
                    'Nmap SSH scripts',
                    'Hydra',
                    'ssh_scan',
                    'Metasploit SSH modules',
                    'sslyze'
                ]
            },
            {
                id: 'telnet',
                name: 'Telnet',
                port: 23,
                category: 'remote',
                description: 'Legacy unencrypted protocol for remote terminal connections.',
                vulnerabilities: [
                    'Clear-text transmission',
                    'No encryption by default',
                    'Susceptible to MITM attacks',
                    'Brute force vulnerabilities',
                    'Default credentials'
                ],
                testing: [
                    'Connect manually: `telnet target.com 23`',
                    'Sniff credentials: `tcpdump -i eth0 -nn port 23 -w telnet.pcap`',
                    'Check for authentication bypass',
                    'Attempt brute force: `hydra -L users.txt -P pass.txt telnet://target.com`',
                    'Look for information leakage in banners'
                ],
                tools: [
                    'Nmap Telnet scripts',
                    'Wireshark',
                    'tcpdump',
                    'Hydra',
                    'Metasploit Telnet modules'
                ]
            },
            {
                id: 'smtp',
                name: 'SMTP',
                port: '25,465,587',
                category: 'messaging',
                description: 'Simple Mail Transfer Protocol used for sending email messages.',
                vulnerabilities: [
                    'Open relay',
                    'SMTP user enumeration',
                    'Outdated SMTP servers',
                    'Cleartext authentication',
                    'SSL/TLS vulnerabilities',
                    'SMTP command injection'
                ],
                testing: [
                    'Test for open relay: `telnet target.com 25`',
                    'User enumeration: `VRFY admin` or `EXPN admin`',
                    'Attempt to enumerate users with tools',
                    'Check for cleartext auth: `nmap --script smtp-commands target.com`',
                    'Test for SMTP command injection'
                ],
                tools: [
                    'Nmap SMTP scripts',
                    'smtp-user-enum',
                    'Metasploit SMTP modules',
                    'swaks',
                    'SMTPTester'
                ]
            },
            {
                id: 'dns',
                name: 'DNS',
                port: '53',
                category: 'other',
                description: 'Domain Name System protocol for resolving domain names to IP addresses.',
                vulnerabilities: [
                    'Zone transfer',
                    'DNS cache poisoning',
                    'DNSSEC issues',
                    'Dynamic DNS vulnerabilities',
                    'Information leakage',
                    'DNS amplification attacks'
                ],
                testing: [
                    'Zone transfer attempt: `dig axfr @target.com domain.com`',
                    'DNS enumeration: `dnsrecon -d domain.com`',
                    'Subdomain discovery: `dnsenum domain.com`',
                    'Check for DNSSEC misconfiguration',
                    'Test for cache poisoning vulnerabilities'
                ],
                tools: [
                    'dig',
                    'nslookup',
                    'dnsenum',
                    'dnsrecon',
                    'fierce',
                    'Sublist3r'
                ]
            },
            {
                id: 'tftp',
                name: 'TFTP',
                port: '69',
                category: 'file',
                description: 'Trivial File Transfer Protocol, a simplified version of FTP with no authentication.',
                vulnerabilities: [
                    'No authentication',
                    'Directory traversal',
                    'File exfiltration',
                    'Sensitive file upload/download',
                    'Outdated TFTP servers'
                ],
                testing: [
                    'Connect and download files: `tftp target.com`',
                    'Try get/put commands on sensitive files',
                    'Attempt directory traversal: `get ../../../etc/passwd`',
                    'Scan for vulnerable TFTP servers: `nmap -sU -p 69 --script tftp-enum target.com`'
                ],
                tools: [
                    'tftp client',
                    'Nmap TFTP scripts',
                    'Metasploit TFTP modules',
                    'tftp-bruteforce',
                    'TFTP utilities'
                ]
            },
            {
                id: 'http',
                name: 'HTTP/HTTPS',
                port: '80,443',
                category: 'web',
                description: 'Hypertext Transfer Protocol and its secure variant for web content delivery.',
                vulnerabilities: [
                    'Injection flaws (SQL, XSS, CSRF)',
                    'Authentication vulnerabilities',
                    'Security misconfigurations',
                    'Sensitive data exposure',
                    'Broken access control',
                    'Outdated components with CVEs',
                    'SSL/TLS issues'
                ],
                testing: [
                    'Web application scanning: `nikto -h target.com`',
                    'Directory brute-force: `gobuster dir -u target.com -w wordlist.txt`',
                    'Check for SSL issues: `sslscan target.com`',
                    'Test for SQL injection: `sqlmap -u "https://target.com/page.php?id=1"`',
                    'Look for sensitive data in source code',
                    'Check for default credentials',
                    'Analyze HTTP headers and cookies'
                ],
                tools: [
                    'Burp Suite',
                    'OWASP ZAP',
                    'Nikto',
                    'Gobuster/Dirbuster',
                    'sqlmap',
                    'sslscan',
                    'Wfuzz'
                ]
            },
            {
                id: 'pop3',
                name: 'POP3',
                port: '110,995',
                category: 'messaging',
                description: 'Post Office Protocol version 3 used by email clients to retrieve emails from a server.',
                vulnerabilities: [
                    'Cleartext authentication (non-SSL)',
                    'Brute force attacks',
                    'MITM attacks',
                    'SSL/TLS vulnerabilities',
                    'Information leakage'
                ],
                testing: [
                    'Connect manually: `telnet target.com 110`',
                    'Check for cleartext auth: `USER username` followed by `PASS password`',
                    'Attempt brute force: `hydra -l user -P passwords.txt pop3://target.com`',
                    'Test SSL/TLS (for POP3S): `openssl s_client -connect target.com:995`'
                ],
                tools: [
                    'Nmap POP3 scripts',
                    'Hydra',
                    'Metasploit POP3 modules',
                    'openssl',
                    'Wireshark'
                ]
            },
            {
                id: 'imap',
                name: 'IMAP',
                port: '143,993',
                category: 'messaging',
                description: 'Internet Message Access Protocol used by email clients to retrieve and manage emails.',
                vulnerabilities: [
                    'Cleartext authentication (non-SSL)',
                    'Brute force attacks',
                    'MITM attacks',
                    'SSL/TLS vulnerabilities',
                    'Information disclosure'
                ],
                testing: [
                    'Connect manually: `telnet target.com 143`',
                    'Login attempt: `a LOGIN username password`',
                    'Attempt brute force: `hydra -l user -P passwords.txt imap://target.com`',
                    'Check SSL/TLS (for IMAPS): `openssl s_client -connect target.com:993`',
                    'List mailboxes: `a LIST "" *`'
                ],
                tools: [
                    'Nmap IMAP scripts',
                    'Hydra',
                    'Metasploit IMAP modules',
                    'openssl',
                    'Wireshark'
                ]
            },
            {
                id: 'rpc',
                name: 'RPC',
                port: '135',
                category: 'other',
                description: 'Remote Procedure Call protocol used for client-server communication in Windows environments.',
                vulnerabilities: [
                    'Information disclosure',
                    'Null sessions',
                    'DCOM vulnerabilities',
                    'RPC buffer overflows',
                    'Authentication bypass'
                ],
                testing: [
                    'Enumerate RPC endpoints: `rpcdump.py target.com`',
                    'Check for null sessions: `rpcclient -U "" -N target.com`',
                    'Scan for RPC vulnerabilities: `nmap -sV -p 135 --script=msrpc-enum target.com`',
                    'Attempt to exploit known RPC CVEs based on version'
                ],
                tools: [
                    'Impacket suite (rpcdump.py)',
                    'Nmap RPC scripts',
                    'rpcclient',
                    'Metasploit RPC modules',
                    'rpcinfo'
                ]
            },
            {
                id: 'netbios',
                name: 'NetBIOS',
                port: '137,138,139',
                category: 'other',
                description: 'Network Basic Input/Output System used for communication in Windows networks.',
                vulnerabilities: [
                    'Information disclosure',
                    'Null sessions',
                    'Remote code execution',
                    'Unauthenticated shares',
                    'Name poisoning'
                ],
                testing: [
                    'NetBIOS name scan: `nbtscan target.com/24`',
                    'Enumerate shares: `smbclient -L //target.com -N`',
                    'Check for null session: `smbclient //target.com/IPC$ -N`',
                    'Try to access shares: `smbclient //target.com/C$ -N`'
                ],
                tools: [
                    'nbtscan',
                    'smbclient',
                    'enum4linux',
                    'Nmap NetBIOS scripts',
                    'Metasploit NetBIOS modules'
                ]
            },
            {
                id: 'smb',
                name: 'SMB/CIFS',
                port: '445',
                category: 'file',
                description: 'Server Message Block/Common Internet File System protocol for shared access to files and printers.',
                vulnerabilities: [
                    'EternalBlue (MS17-010)',
                    'SMBGhost (CVE-2020-0796)',
                    'Null sessions',
                    'Weak share permissions',
                    'SMB relay attacks',
                    'SMB signing disabled',
                    'Outdated SMB versions'
                ],
                testing: [
                    'Enumerate shares: `smbclient -L //target.com -N`',
                    'Check for vulnerable SMB versions: `nmap --script smb-protocols target.com`',
                    'Scan for MS17-010: `nmap --script smb-vuln-ms17-010 target.com`',
                    'Test for null sessions: `smbmap -H target.com`',
                    'Try to access shares anonymously: `crackmapexec smb target.com --shares`'
                ],
                tools: [
                    'smbclient',
                    'smbmap',
                    'CrackMapExec',
                    'enum4linux',
                    'Nmap SMB scripts',
                    'Metasploit SMB modules',
                    'Responder'
                ]
            },
            {
                id: 'ldap',
                name: 'LDAP',
                port: '389,636',
                category: 'directory',
                description: 'Lightweight Directory Access Protocol for accessing and maintaining directory services.',
                vulnerabilities: [
                    'Anonymous binding',
                    'Cleartext credentials',
                    'Information disclosure',
                    'Weak LDAP authentication',
                    'Improper access controls',
                    'LDAP injection'
                ],
                testing: [
                    'Check for anonymous binding: `ldapsearch -x -H ldap://target.com -b "dc=domain,dc=com"`',
                    'Enumerate users: `ldapsearch -x -H ldap://target.com -b "dc=domain,dc=com" "objectClass=user"`',
                    'Look for sensitive data in LDAP directory',
                    'Test for LDAP injection in web applications',
                    'Attempt brute force: `nmap --script ldap-brute target.com`'
                ],
                tools: [
                    'ldapsearch',
                    'JXplorer',
                    'Nmap LDAP scripts',
                    'LDAPDomainDump',
                    'windapsearch',
                    'Metasploit LDAP modules'
                ]
            },
            {
                id: 'snmp',
                name: 'SNMP',
                port: '161,162',
                category: 'monitoring',
                description: 'Simple Network Management Protocol used to manage and monitor network devices.',
                vulnerabilities: [
                    'Default community strings',
                    'Information disclosure',
                    'SNMP versions 1/2c weaknesses',
                    'Weak authentication in SNMP v3',
                    'SNMP DoS attacks',
                    'MIB enumeration'
                ],
                testing: [
                    'Scan for SNMP: `nmap -sU -p 161 target.com/24`',
                    'Community string brute force: `onesixtyone -c community.txt target.com`',
                    'Walk the MIB tree: `snmpwalk -v2c -c public target.com`',
                    'Enumerate users: `snmpwalk -v2c -c public target.com 1.3.6.1.4.1.77.1.2.25`',
                    'Check for writeable OIDs: `snmpset`'
                ],
                tools: [
                    'onesixtyone',
                    'snmpwalk',
                    'snmpcheck',
                    'braa',
                    'Nmap SNMP scripts',
                    'Metasploit SNMP modules'
                ]
            },
            {
                id: 'rdp',
                name: 'RDP',
                port: '3389',
                category: 'remote',
                description: 'Remote Desktop Protocol for graphical remote access to Windows systems.',
                vulnerabilities: [
                    'BlueKeep (CVE-2019-0708)',
                    'Weak credentials',
                    'NLA bypass',
                    'MitM attacks',
                    'Session hijacking',
                    'RDP login brute forcing'
                ],
                testing: [
                    'Scan for RDP: `nmap -p 3389 --script rdp-ntlm-info target.com`',
                    'Check for BlueKeep: `nmap --script rdp-vuln-ms12-020 target.com`',
                    'Test for NLA: `ncrack -vv --user administrator -P passwords.txt rdp://target.com`',
                    'Attempt brute force: `hydra -l administrator -P passwords.txt rdp://target.com`'
                ],
                tools: [
                    'Nmap RDP scripts',
                    'Hydra',
                    'Ncrack',
                    'RDP-sec-check',
                    'Metasploit RDP modules',
                    'rdesktop',
                    'FreeRDP'
                ]
            },
            {
                id: 'vnc',
                name: 'VNC',
                port: '5900',
                category: 'remote',
                description: 'Virtual Network Computing protocol for graphical desktop sharing.',
                vulnerabilities: [
                    'Weak/default passwords',
                    'Authentication bypass',
                    'Unencrypted connections',
                    'Information disclosure',
                    'Outdated VNC servers'
                ],
                testing: [
                    'Scan for VNC: `nmap -p 5900 --script vnc-info target.com`',
                    'Check for no auth: `vncviewer target.com:5900`',
                    'Attempt brute force: `hydra -P passwords.txt vnc://target.com`',
                    'Look for VNC password files on compromised systems'
                ],
                tools: [
                    'Nmap VNC scripts',
                    'vncviewer',
                    'Hydra',
                    'Metasploit VNC modules',
                    'vncrack'
                ]
            },
            {
                id: 'redis',
                name: 'Redis',
                port: '6379',
                category: 'database',
                description: 'In-memory data structure store used as a database, cache, and message broker.',
                vulnerabilities: [
                    'Unprotected instances',
                    'Weak authentication',
                    'Command execution via configuration',
                    'Data exposure',
                    'SSH key writing for access'
                ],
                testing: [
                    'Connect to Redis: `redis-cli -h target.com`',
                    'Check authentication: `AUTH password` or try without auth',
                    'Enumerate info: `INFO`',
                    'Try to modify config: `CONFIG SET dir /var/www/html/`',
                    'Attempt to write SSH key: `CONFIG SET dbfilename "authorized_keys"`'
                ],
                tools: [
                    'redis-cli',
                    'Nmap Redis scripts',
                    'Metasploit Redis modules',
                    'Redis Desktop Manager',
                    'redis-rce'
                ]
            },
            {
                id: 'nfs',
                name: 'NFS',
                port: '2049',
                category: 'file',
                description: 'Network File System protocol for distributed file access.',
                vulnerabilities: [
                    'Misconfigured exports',
                    'Anonymous access',
                    'Weak file permissions',
                    'NFS squashing bypass',
                    'Information disclosure'
                ],
                testing: [
                    'Enumerate NFS shares: `showmount -e target.com`',
                    'Mount NFS share: `mount -t nfs target.com:/share /mnt/nfs`',
                    'Check file permissions on mounted share',
                    'Look for sensitive files & user data',
                    'Check no_root_squash misconfiguration'
                ],
                tools: [
                    'showmount',
                    'mount',
                    'Nmap NFS scripts',
                    'NFSShell',
                    'Metasploit NFS modules'
                ]
            },
            {
                id: 'mysql',
                name: 'MySQL',
                port: '3306',
                category: 'database',
                description: 'Popular open-source relational database management system.',
                vulnerabilities: [
                    'Weak credentials',
                    'Default credentials',
                    'Public facing instances',
                    'User privilege escalation',
                    'SQL injection',
                    'CVEs in outdated versions'
                ],
                testing: [
                    'Connect to MySQL: `mysql -h target.com -u root -p`',
                    'Enumerate MySQL users: `SELECT user,host,password FROM mysql.user;`',
                    'Check for SQL injection in web apps',
                    'Attempt brute force: `hydra -l root -P passwords.txt mysql://target.com`',
                    'Look for MySQL UDFs for privilege escalation'
                ],
                tools: [
                    'mysql client',
                    'Nmap MySQL scripts',
                    'sqlmap',
                    'Metasploit MySQL modules',
                    'MySQLdump',
                    'Hydra'
                ]
            },
            {
                id: 'postgresql',
                name: 'PostgreSQL',
                port: '5432',
                category: 'database',
                description: 'Advanced open-source relational database system.',
                vulnerabilities: [
                    'Weak credentials',
                    'Default credentials',
                    'Trust authentication',
                    'Command execution via functions',
                    'Information disclosure',
                    'CVEs in outdated versions'
                ],
                testing: [
                    'Connect to PostgreSQL: `psql -h target.com -U postgres`',
                    'Attempt brute force: `hydra -l postgres -P passwords.txt postgres://target.com`',
                    'Check for trust authentication in pg_hba.conf',
                    'Execute system commands: `SELECT pg_ls_dir(\'/etc\');`',
                    'Create malicious functions using `CREATE FUNCTION`'
                ],
                tools: [
                    'psql client',
                    'Nmap PostgreSQL scripts',
                    'Metasploit PostgreSQL modules',
                    'sqlmap',
                    'pgadmin'
                ]
            },
            {
                id: 'mongodb',
                name: 'MongoDB',
                port: '27017',
                category: 'database',
                description: 'Popular NoSQL document-oriented database.',
                vulnerabilities: [
                    'Unauthenticated access',
                    'Default configuration weaknesses',
                    'Injection attacks (NoSQL)',
                    'Weak credentials',
                    'Information disclosure',
                    'Outdated versions with CVEs'
                ],
                testing: [
                    'Connect to MongoDB: `mongo target.com:27017`',
                    'Check for authentication: try commands without auth',
                    'List databases: `show dbs`',
                    'Enumerate collections: `show collections`',
                    'Check for NoSQL injection in web applications',
                    'Extract data: `db.collection.find()`'
                ],
                tools: [
                    'mongo client',
                    'Nmap MongoDB scripts',
                    'NoSQLMap',
                    'Metasploit MongoDB modules',
                    'MongoDB Compass'
                ]
            },
            {
                id: 'mssql',
                name: 'MSSQL',
                port: '1433',
                category: 'database',
                description: 'Microsoft SQL Server database system.',
                vulnerabilities: [
                    'Weak SA password',
                    'SQL injection',
                    'xp_cmdshell RCE',
                    'NTLM relay attacks',
                    'Excessive privileges',
                    'Information disclosure'
                ],
                testing: [
                    'Connect to MSSQL: `sqsh -S target.com -U sa -P password`',
                    'Attempt brute force: `hydra -l sa -P passwords.txt mssql://target.com`',
                    'Check for xp_cmdshell: `EXEC master..xp_cmdshell \'whoami\'`',
                    'Enumerate users: `SELECT name FROM master..syslogins`',
                    'Check for impersonation: `SELECT name FROM sys.server_principals WHERE IS_SRVROLEMEMBER(\'sysadmin\', name) = 1`'
                ],
                tools: [
                    'sqsh',
                    'Nmap MSSQL scripts',
                    'sqlmap',
                    'Metasploit MSSQL modules',
                    'PowerUpSQL',
                    'Responder (for NTLM relay)'
                ]
            },
            {
                id: 'oracle',
                name: 'Oracle',
                port: '1521',
                category: 'database',
                description: 'Enterprise database management system from Oracle Corporation.',
                vulnerabilities: [
                    'Default credentials',
                    'TNS poisoning',
                    'PL/SQL injection',
                    'CVEs in outdated versions',
                    'Privilege escalation via packages',
                    'Information disclosure'
                ],
                testing: [
                    'Connect to Oracle: `sqlplus username/password@target.com:1521/SID`',
                    'Enumerate SIDs: `odat sidguesser -s target.com -p 1521`',
                    'Check default credentials: `hydra -L users.txt -P passwords.txt oracle-listener://target.com`',
                    'Test for TNS poisoning',
                    'Try to execute OS commands via DBMS_SCHEDULER or Java stored procedures'
                ],
                tools: [
                    'sqlplus',
                    'odat',
                    'Nmap Oracle scripts',
                    'Metasploit Oracle modules',
                    'oscanner',
                    'sqlmap'
                ]
            },
            {
                id: 'kerberos',
                name: 'Kerberos',
                port: '88',
                category: 'directory',
                description: 'Network authentication protocol for secure authentication on potentially insecure networks.',
                vulnerabilities: [
                    'Kerberoasting',
                    'AS-REP Roasting',
                    'Pass-the-ticket',
                    'Golden ticket attacks',
                    'Silver ticket attacks',
                    'Weak passwords',
                    'Improper implementation'
                ],
                testing: [
                    'Enumerate users: `kerbrute userenum -d domain.com users.txt`',
                    'Kerberoasting: `GetUserSPNs.py domain.com/user:password -request`',
                    'AS-REP Roasting: `GetNPUsers.py domain.com/ -usersfile users.txt -format hashcat`',
                    'Check for overly permissive delegation',
                    'Test for password spraying: `kerbrute passwordspray -d domain.com users.txt password`'
                ],
                tools: [
                    'Impacket suite (GetUserSPNs.py, GetNPUsers.py)',
                    'Rubeus',
                    'kerbrute',
                    'Mimikatz',
                    'Metasploit Kerberos modules',
                    'Hashcat (for cracking)'
                ]
            },
            {
                id: 'ipsec',
                name: 'IPsec/IKE',
                port: '500',
                category: 'other',
                description: 'Internet Protocol Security protocol suite for secure IP communications.',
                vulnerabilities: [
                    'Weak PSK',
                    'Aggressive mode weaknesses',
                    'Cipher weaknesses',
                    'Configuration errors',
                    'VPN fingerprinting',
                    'Known CVEs'
                ],
                testing: [
                    'Scan for IKE: `ike-scan target.com`',
                    'Test aggressive mode: `ike-scan -M -A target.com`',
                    'Attempt to capture handshake: `ike-scan --showbackoff target.com`',
                    'Brute force PSK: `psk-crack -b 5 psk.txt handshake.pcap`',
                    'Check for vendor implementation weaknesses'
                ],
                tools: [
                    'ike-scan',
                    'psk-crack',
                    'ikeforce',
                    'ipsec-tools',
                    'strongswan',
                    'Nmap ike scripts'
                ]
            },
            {
                id: 'pptp',
                name: 'PPTP',
                port: '1723',
                category: 'other',
                description: 'Point-to-Point Tunneling Protocol for VPN connections.',
                vulnerabilities: [
                    'MS-CHAPv2 weaknesses',
                    'Encryption flaws',
                    'Brute force attacks',
                    'Implementation flaws',
                    'VPN filtering bypass'
                ],
                testing: [
                    'Scan for PPTP: `nmap -p 1723 --script pptp-version target.com`',
                    'Capture PPTP authentication handshake with Wireshark',
                    'Crack MS-CHAPv2 authentication using chapcrack',
                    'Test for implementation vulnerabilities',
                    'Attempt brute force on VPN credentials'
                ],
                tools: [
                    'Nmap PPTP scripts',
                    'Wireshark',
                    'chapcrack',
                    'pptpd',
                    'Metasploit PPTP modules',
                    'THC-pptp-bruter'
                ]
            },
            {
                id: 'sip',
                name: 'SIP',
                port: '5060,5061',
                category: 'messaging',
                description: 'Session Initiation Protocol used for VoIP communications.',
                vulnerabilities: [
                    'SIP digest authentication weaknesses',
                    'Extension enumeration',
                    'Vishing attacks',
                    'Call eavesdropping',
                    'Toll fraud',
                    'DoS attacks'
                ],
                testing: [
                    'Scan for SIP: `nmap -sU -p 5060 --script sip-methods target.com`',
                    'Enumerate SIP extensions: `svmap target.com`',
                    'Attempt brute force: `svcrack -u100 -d dictionary.txt target.com`',
                    'Intercept SIP traffic with Wireshark',
                    'Test for unauthorized access to SIP trunks'
                ],
                tools: [
                    'SIPVicious suite (svmap, svwar, svcrack)',
                    'Nmap SIP scripts',
                    'Wireshark',
                    'Metasploit SIP modules',
                    'SIP-Scan',
                    'inviteflood'
                ]
            },
            {
                id: 'irc',
                name: 'IRC',
                port: '6667',
                category: 'messaging',
                description: 'Internet Relay Chat protocol for text messaging and communication.',
                vulnerabilities: [
                    'Unencrypted communication',
                    'Authentication weaknesses',
                    'IRC bot vulnerabilities',
                    'Information disclosure',
                    'Outdated IRC servers',
                    'DDoS amplification'
                ],
                testing: [
                    'Connect to IRC: `irssi -c target.com`',
                    'Enumerate channels: `/list`',
                    'Check for bot commands',
                    'Look for sensitive information in topic/messages',
                    'Test for command injection in IRC bots',
                    'Check for outdated IRC server versions with CVEs'
                ],
                tools: [
                    'irssi',
                    'WeeChat',
                    'Nmap IRC scripts',
                    'Metasploit IRC modules',
                    'IRCRecon',
                    'Wireshark'
                ]
            },
            {
                id: 'rtsp',
                name: 'RTSP',
                port: '554',
                category: 'other',
                description: 'Real-Time Streaming Protocol used for controlling streaming media servers.',
                vulnerabilities: [
                    'Default credentials',
                    'Unauthenticated streams',
                    'Information disclosure',
                    'RTSP methods exploitation',
                    'Stream interception',
                    'DoS attacks'
                ],
                testing: [
                    'Enumerate RTSP: `nmap -sV -p 554 --script rtsp-methods target.com`',
                    'Attempt to connect: `openrtsp rtsp://target.com/stream`',
                    'Test for default credentials on cameras',
                    'Check for unauthenticated access to streams',
                    'Look for information disclosure in RTSP headers',
                    'Brute force authentication: `hydra -l admin -P passwords.txt rtsp://target.com`'
                ],
                tools: [
                    'openrtsp',
                    'Nmap RTSP scripts',
                    'VLC media player',
                    'rtspbrute',
                    'Wireshark with RTSP dissector',
                    'FFmpeg'
                ]
            },
            {
                id: 'rsync',
                name: 'Rsync',
                port: '873',
                category: 'file',
                description: 'File synchronization protocol and utility for Unix-like systems.',
                vulnerabilities: [
                    'Anonymous access',
                    'Misconfigured modules',
                    'Weak authentication',
                    'Information disclosure',
                    'Writable shares',
                    'Outdated rsync versions'
                ],
                testing: [
                    'List available modules: `rsync rsync://target.com/`',
                    'Check for anonymous access: `rsync rsync://target.com/share/`',
                    'Attempt to access sensitive data: `rsync rsync://target.com/share/etc/`',
                    'Check if shares are writable: `rsync file.txt rsync://target.com/share/`',
                    'Look for configuration errors'
                ],
                tools: [
                    'rsync client',
                    'Nmap rsync scripts',
                    'Metasploit rsync modules',
                    'enum4linux',
                    'rsyncbrute'
                ]
            },
            {
                id: 'cups',
                name: 'CUPS',
                port: '631',
                category: 'other',
                description: 'Common Unix Printing System for handling print jobs and managing printers.',
                vulnerabilities: [
                    'Information disclosure',
                    'Default credentials',
                    'Unauthenticated access',
                    'Outdated versions with CVEs',
                    'File write/read vulnerabilities',
                    'DoS conditions'
                ],
                testing: [
                    'Access web interface: `http://target.com:631/`',
                    'Enumerate printers: `lpstat -h target.com -a`',
                    'Check for unauthenticated admin access',
                    'Look for printer queue information',
                    'Test for default/weak credentials',
                    'Check version for known CVEs'
                ],
                tools: [
                    'lpstat',
                    'lpadmin',
                    'CUPS web interface',
                    'Nmap CUPS scripts',
                    'Metasploit CUPS modules',
                    'Burp Suite (for web interface testing)'
                ]
            },
            {
                id: 'memcached',
                name: 'Memcached',
                port: '11211',
                category: 'database',
                description: 'In-memory key-value store for small chunks of data from database calls, API calls, or page rendering.',
                vulnerabilities: [
                    'Unauthenticated access',
                    'Information disclosure',
                    'Data exposure',
                    'DDOS amplification',
                    'Remote code execution through deserialization',
                    'Default configuration issues'
                ],
                testing: [
                    'Connect to Memcached: `telnet target.com 11211`',
                    'List all keys: `stats items` followed by `stats cachedump [slab_id] 0`',
                    'Retrieve values: `get [key]`',
                    'Check for DDOS amplification: `stats`',
                    'Look for sensitive data in cached keys'
                ],
                tools: [
                    'telnet/nc',
                    'memcached-cli',
                    'memcdump',
                    'Nmap Memcached scripts',
                    'Metasploit Memcached modules',
                    'memcached-tool'
                ]
            },
            {
                id: 'elasticsearch',
                name: 'Elasticsearch',
                port: '9200,9300',
                category: 'database',
                description: 'Distributed, RESTful search and analytics engine.',
                vulnerabilities: [
                    'Unauthenticated access',
                    'Information disclosure',
                    'Remote code execution via Groovy scripts',
                    'Sensitive data exposure',
                    'CVEs in outdated versions',
                    'Insecure configuration'
                ],
                testing: [
                    'Check for unauthenticated access: `curl http://target.com:9200/`',
                    'List all indices: `curl http://target.com:9200/_cat/indices`',
                    'Query sensitive data: `curl http://target.com:9200/_search?q=password`',
                    'Check for RCE via scripts: `curl -X POST "http://target.com:9200/_search" -d \'{"script_fields": {"exploit": {"script": "java.lang.Math.class.forName(\\"java.lang.Runtime\\").getRuntime().exec(\\"id\\").getText()"}}}\' -H \'Content-Type: application/json\'`',
                    'Look for cluster information: `curl http://target.com:9200/_cluster/health`'
                ],
                tools: [
                    'curl',
                    'Nmap Elasticsearch scripts',
                    'Metasploit Elasticsearch modules',
                    'elasticsearch-dump',
                    'Burp Suite',
                    'searchsploit elasticsearch'
                ]
            },
            {
                id: 'docker',
                name: 'Docker',
                port: '2375,2376',
                category: 'other',
                description: 'Platform for developing, shipping, and running applications in containers.',
                vulnerabilities: [
                    'Unauthenticated Docker API access',
                    'Container escape',
                    'Exposed Docker socket',
                    'Privileged containers',
                    'Weak configuration',
                    'Image vulnerabilities'
                ],
                testing: [
                    'Check for unauthenticated API: `curl http://target.com:2375/version`',
                    'List containers: `curl http://target.com:2375/containers/json`',
                    'Create privileged container: `curl -X POST -H "Content-Type: application/json" http://target.com:2375/containers/create -d \'{"Image":"alpine","Cmd":["/bin/sh"],"Binds":["/:/host"], "Privileged": true}\'`',
                    'Execute commands: `curl -X POST http://target.com:2375/containers/[ID]/exec -d \'{"Cmd":["cat", "/etc/shadow"], "AttachStdout": true}\'`',
                    'Look for exposed Docker socket in web apps: `/var/run/docker.sock`'
                ],
                tools: [
                    'curl',
                    'docker client',
                    'Nmap Docker scripts',
                    'Metasploit Docker modules',
                    'DockerScan',
                    'dive (for image analysis)'
                ]
            },
            {
                id: 'kubernetes',
                name: 'Kubernetes API',
                port: '6443,8080',
                category: 'other',
                description: 'Container orchestration platform for automating deployment, scaling, and management of containerized applications.',
                vulnerabilities: [
                    'Unauthenticated API access',
                    'Insecure configurations',
                    'RBAC misconfiguration',
                    'Exposed Dashboards',
                    'Service account token abuse',
                    'Container escape'
                ],
                testing: [
                    'Check for unauthenticated API: `curl https://target.com:6443/ -k`',
                    'Verify anonymous access: `curl https://target.com:6443/api/v1/namespaces -k`',
                    'Look for exposed dashboard: `https://target.com:30000/`',
                    'Check for overly permissive RBAC: `kubectl auth can-i --list`',
                    'Create privileged pod if authorized: `kubectl apply -f pod.yaml`',
                    'Test for pod escape vulnerabilities'
                ],
                tools: [
                    'kubectl',
                    'curl',
                    'kubeaudit',
                    'kube-hunter',
                    'Nmap Kubernetes scripts',
                    'Metasploit Kubernetes modules',
                    'kubesec'
                ]
            },
            {
                id: 'ipmi',
                name: 'IPMI',
                port: '623',
                category: 'other',
                description: 'Intelligent Platform Management Interface for out-of-band management of computer systems.',
                vulnerabilities: [
                    'Default credentials',
                    'Cipher zero authentication bypass',
                    'Remote code execution',
                    'Information disclosure',
                    'Hash disclosure for offline cracking',
                    'IPMI 2.0 password hash exposure'
                ],
                testing: [
                    'Scan for IPMI: `nmap -sU -p 623 --script ipmi-version target.com`',
                    'Try cipher zero auth: `ipmitool -I lanplus -H target.com -U admin -P admin -C 0 user list`',
                    'Attempt to dump hashes: `ipmitool -I lanplus -H target.com -U admin -P admin user list`',
                    'Check for default credentials',
                    'Test for known CVEs based on BMC version'
                ],
                tools: [
                    'ipmitool',
                    'Metasploit IPMI modules',
                    'ipmiping',
                    'Nmap IPMI scripts',
                    'racoon',
                    'hashcat (for cracking IPMI hashes)'
                ]
            },
            {
                id: 'winrm',
                name: 'WinRM',
                port: '5985,5986',
                category: 'remote',
                description: 'Windows Remote Management for remote system management via SOAP requests.',
                vulnerabilities: [
                    'Weak credentials',
                    'Authentication bypass',
                    'Improper access controls',
                    'Cleartext credentials',
                    'Information disclosure',
                    'Unencrypted communications (HTTP)'
                ],
                testing: [
                    'Check if WinRM is running: `nmap -p 5985,5986 target.com`',
                    'Test credentials: `evil-winrm -i target.com -u administrator -p password`',
                    'Attempt brute force: `crackmapexec winrm target.com -u users.txt -p passwords.txt`',
                    'Check for HTTP/unencrypted WinRM: `-p 5985`',
                    'Try known exploits for the identified WinRM version'
                ],
                tools: [
                    'evil-winrm',
                    'CrackMapExec',
                    'Metasploit WinRM modules',
                    'Nmap WinRM scripts',
                    'Invoke-WinRMBruteForce.ps1',
                    'WinRM Ruby Client'
                ]
            },
            {
                id: 'x11',
                name: 'X11',
                port: '6000-6005',
                category: 'other',
                description: 'X Window System protocol for providing GUI in Unix-like systems.',
                vulnerabilities: [
                    'Unauthenticated access',
                    'X11 forwarding issues',
                    'Keylogging',
                    'Screen capture',
                    'Information disclosure',
                    'Insufficient authentication'
                ],
                testing: [
                    'Check for open X11: `nmap -p 6000-6005 target.com`',
                    'Attempt to connect: `xdpyinfo -display target.com:0`',
                    'Capture screenshots: `xwd -root -screen -silent -display target.com:0 > screenshot.xwd`',
                    'Keylogging: `xinput test $(xinput list --id-only "keyboard") -display target.com:0`',
                    'Test for X11 authentication bypass'
                ],
                tools: [
                    'xhost',
                    'xdpyinfo',
                    'xwd',
                    'xinput',
                    'Nmap X11 scripts',
                    'Metasploit X11 modules',
                    'XSpy'
                ]
            },
            {
                id: 'xmpp',
                name: 'XMPP',
                port: '5222,5269',
                category: 'messaging',
                description: 'Extensible Messaging and Presence Protocol for instant messaging, presence, and request-response services.',
                vulnerabilities: [
                    'Information disclosure',
                    'Username enumeration',
                    'Weak authentication',
                    'TLS/SSL issues',
                    'Message interception',
                    'DoS vulnerabilities'
                ],
                testing: [
                    'Connect to XMPP server: `sendxmpp -v -j target.com -u user -p password`',
                    'Enumerate users: `xmpp-user-enum -j target.com -d wordlist.txt`',
                    'Check for TLS issues: `openssl s_client -connect target.com:5222 -starttls xmpp`',
                    'Test for message interception',
                    'Identify XMPP server software and version'
                ],
                tools: [
                    'sendxmpp',
                    'xmpp-user-enum',
                    'profanity (XMPP client)',
                    'pidgin',
                    'Nmap XMPP scripts',
                    'Metasploit XMPP modules'
                ]
            },
            {
                id: 'smtp-submission',
                name: 'SMTP Submission',
                port: '587',
                category: 'messaging',
                description: 'SMTP port for message submission with authentication requirement.',
                vulnerabilities: [
                    'Cleartext credentials',
                    'STARTTLS downgrade',
                    'Outdated SMTP server',
                    'Relay issues',
                    'Authentication bypass',
                    'Information disclosure'
                ],
                testing: [
                    'Connect to SMTP: `telnet target.com 587`',
                    'Test for STARTTLS: `STARTTLS`',
                    'Check for enumeration: `VRFY admin` or `EXPN admin`',
                    'Attempt to relay: Send email from non-local domain',
                    'Look for version info in banner',
                    'Test for authentication bypass'
                ],
                tools: [
                    'telnet/nc',
                    'swaks',
                    'Nmap SMTP scripts',
                    'Metasploit SMTP modules',
                    'smtp-user-enum',
                    'openssl (for testing STARTTLS)'
                ]
            },
            {
                id: 'dhcp',
                name: 'DHCP',
                port: '67,68',
                category: 'other',
                description: 'Dynamic Host Configuration Protocol for automating the configuration of devices on IP networks.',
                vulnerabilities: [
                    'DHCP starvation',
                    'Rogue DHCP server',
                    'DHCP snooping bypass',
                    'Information disclosure',
                    'MitM via DHCP',
                    'Malicious options'
                ],
                testing: [
                    'Identify DHCP server: `nmap --script broadcast-dhcp-discover`',
                    'Test DHCP starvation: `dhcpstarv -i eth0`',
                    'Set up rogue DHCP server to test for controls',
                    'Check for DHCP snooping effectiveness',
                    'Analyze DHCP options for information disclosure'
                ],
                tools: [
                    'dhcpstarv',
                    'dhcpdump',
                    'Yersinia',
                    'Nmap DHCP scripts',
                    'Metasploit DHCP modules',
                    'Wireshark'
                ]
            },
            {
                id: 'radius',
                name: 'RADIUS',
                port: '1812,1813',
                category: 'other',
                description: 'Remote Authentication Dial-In User Service for centralized authentication, authorization, and accounting.',
                vulnerabilities: [
                    'Weak shared secrets',
                    'Dictionary attacks',
                    'Information disclosure',
                    'Cleartext attributes',
                    'RADIUS server bypass',
                    'Default credentials'
                ],
                testing: [
                    'Identify RADIUS server: `nmap -sU -p 1812,1813 target.com`',
                    'Test authentication: `radtest username password target.com 0 testing123`',
                    'Attempt brute force: `radtest-wrapper.py -u users.txt -p passwords.txt -t target.com`',
                    'Check for shared secret issues',
                    'Capture and analyze RADIUS traffic with Wireshark'
                ],
                tools: [
                    'radtest',
                    'radsniff',
                    'Nmap RADIUS scripts',
                    'Metasploit RADIUS modules',
                    'radicale',
                    'eapmd5pass'
                ]
            },
            {
                id: 'tacacs',
                name: 'TACACS',
                port: '49',
                category: 'other',
                description: 'Terminal Access Controller Access-Control System for authentication, authorization, and accounting.',
                vulnerabilities: [
                    'Weak credentials',
                    'Cleartext transmission',
                    'Outdated implementations',
                    'Information disclosure',
                    'Insufficient logging',
                    'ACL bypass'
                ],
                testing: [
                    'Identify TACACS+ server: `nmap -p 49 target.com`',
                    'Test authentication: `tacacs-client -u username -p password -s shared_secret -r target.com`',
                    'Attempt to capture traffic for offline analysis',
                    'Check for weak encryption (older versions)',
                    'Look for device configurations with TACACS secrets'
                ],
                tools: [
                    'tacacs-client',
                    'Nmap TACACS scripts',
                    'Wireshark',
                    'tac_plus (for testing)',
                    'Metasploit TACACS modules',
                    'TACOS (TACACS+ server)'
                ]
            },
            {
                id: 'cassandra',
                name: 'Cassandra',
                port: '9042',
                category: 'database',
                description: 'Distributed NoSQL database designed for handling large amounts of data.',
                vulnerabilities: [
                    'Default credentials',
                    'Unauthenticated access',
                    'Information disclosure',
                    'Weak authentication',
                    'JMX vulnerabilities',
                    'RCE via triggers'
                ],
                testing: [
                    'Connect to Cassandra: `cqlsh target.com 9042`',
                    'Check for default credentials: `cqlsh target.com -u cassandra -p cassandra`',
                    'List keyspaces: `SELECT * FROM system.schema_keyspaces;`',
                    'Check user roles: `SELECT * FROM system_auth.roles;`',
                    'Look for sensitive data in tables',
                    'Test for JMX exposure on port 7199'
                ],
                tools: [
                    'cqlsh',
                    'Nmap Cassandra scripts',
                    'Metasploit Cassandra modules',
                    'nodetool',
                    'cassandra-cli',
                    'jmxterm (for JMX testing)'
                ]
            },
            {
                id: 'couchdb',
                name: 'CouchDB',
                port: '5984',
                category: 'database',
                description: 'Document-oriented NoSQL database with HTTP API access.',
                vulnerabilities: [
                    'Unauthenticated access',
                    'Admin party mode',
                    'Information disclosure',
                    'Remote code execution CVEs',
                    'Authentication bypasses',
                    'Improper access controls'
                ],
                testing: [
                    'Access CouchDB: `curl http://target.com:5984/`',
                    'List all databases: `curl http://target.com:5984/_all_dbs`',
                    'Check for admin party (no auth): `curl http://target.com:5984/_users`',
                    'Test admin credentials: `curl -u admin:password http://target.com:5984/_config`',
                    'Look for sensitive information in databases',
                    'Check for CVEs based on version'
                ],
                tools: [
                    'curl',
                    'Nmap CouchDB scripts',
                    'Metasploit CouchDB modules',
                    'Burp Suite',
                    'couchdb-dump',
                    'node-couch'
                ]
            },
            {
                id: 'hadoop',
                name: 'Hadoop',
                port: '50070,50075,8088',
                category: 'other',
                description: 'Framework for distributed storage and processing of big data.',
                vulnerabilities: [
                    'Unauthenticated access',
                    'Weak authentication',
                    'Information disclosure',
                    'YARN resource manager attacks',
                    'NameNode vulnerabilities',
                    'Default configurations'
                ],
                testing: [
                    'Access HDFS web interface: `http://target.com:50070/`',
                    'Check YARN interface: `http://target.com:8088/`',
                    'List HDFS directories: `curl http://target.com:50070/webhdfs/v1/?op=LISTSTATUS`',
                    'Test for unauthenticated job submission: `curl -X POST http://target.com:8088/ws/v1/cluster/apps/new-application`',
                    'Look for sensitive data in HDFS',
                    'Check for default configurations'
                ],
                tools: [
                    'curl',
                    'hdfs client',
                    'Nmap Hadoop scripts',
                    'Metasploit Hadoop modules',
                    'hadoop-attack-library',
                    'Burp Suite'
                ]
            },
            {
                id: 'rabbitmq',
                name: 'RabbitMQ',
                port: '5672,15672',
                category: 'messaging',
                description: 'Message broker that implements Advanced Message Queuing Protocol (AMQP).',
                vulnerabilities: [
                    'Default credentials',
                    'Unauthenticated access',
                    'Information disclosure',
                    'Weak authentication',
                    'Excessive permissions',
                    'Message interception'
                ],
                testing: [
                    'Access management interface: `http://target.com:15672/`',
                    'Test default credentials: `guest:guest`',
                    'Connect to AMQP: `amqp-client target.com 5672`',
                    'Check for exposed queues and exchanges',
                    'Test for weak authorizations on vhosts',
                    'Attempt to intercept messages'
                ],
                tools: [
                    'curl',
                    'amqp-client',
                    'Nmap RabbitMQ scripts',
                    'Burp Suite',
                    'Metasploit RabbitMQ modules',
                    'rabbitmqadmin'
                ]
            },
            {
                id: 'kafka',
                name: 'Kafka',
                port: '9092',
                category: 'messaging',
                description: 'Distributed streaming platform for building real-time data pipelines.',
                vulnerabilities: [
                    'Unauthenticated access',
                    'Weak authentication',
                    'Information disclosure',
                    'Insecure defaults',
                    'Topic permissions issues',
                    'SASL vulnerabilities'
                ],
                testing: [
                    'Enumerate topics: `kafkacat -L -b target.com:9092`',
                    'Read messages: `kafkacat -C -b target.com:9092 -t sensitive_topic`',
                    'Test for unauthenticated producer access: `echo "test" | kafkacat -P -b target.com:9092 -t test`',
                    'Check for ACL misconfigurations',
                    'Attempt to access __consumer_offsets topic',
                    'Test SASL authentication if enabled'
                ],
                tools: [
                    'kafkacat',
                    'kafka-console-consumer',
                    'kafka-console-producer',
                    'Burp Suite',
                    'Metasploit Kafka modules',
                    'kafka-security'
                ]
            },
            {
                id: 'zookeeper',
                name: 'ZooKeeper',
                port: '2181',
                category: 'other',
                description: 'Coordination service for distributed applications.',
                vulnerabilities: [
                    'Unauthenticated access',
                    'Information disclosure',
                    'ACL misconfigurations',
                    'Administrative commands',
                    'Four-letter commands exposure',
                    'Sensitive data in znodes'
                ],
                testing: [
                    'Connect to ZooKeeper: `telnet target.com 2181`',
                    'Try four-letter commands: `stat`, `dump`, `conf`, `ruok`, `envi`',
                    'List znodes: `ls /`',
                    'Get sensitive data: `get /path/to/data`',
                    'Check for ACL misconfiguration: `getAcl /path`',
                    'Test for administrative access'
                ],
                tools: [
                    'telnet/nc',
                    'zkCli.sh',
                    'Nmap ZooKeeper scripts',
                    'zookeeper-cli',
                    'Metasploit ZooKeeper modules',
                    'zk-shell'
                ]
            },
            {
                id: 'jenkins',
                name: 'Jenkins',
                port: '8080',
                category: 'web',
                description: 'Open-source automation server for building, testing, and deploying code.',
                vulnerabilities: [
                    'Unauthenticated access',
                    'Default/weak credentials',
                    'Script Console RCE',
                    'Plugin vulnerabilities',
                    'Metaprogramming RCE',
                    'Authentication bypass CVEs'
                ],
                testing: [
                    'Access Jenkins: `http://target.com:8080/`',
                    'Check for authentication bypass: `http://target.com:8080/script`',
                    'Test default credentials: `admin:password`',
                    'Check for outdated plugins',
                    'Attempt to execute Groovy scripts',
                    'Look for Jenkins-Cli RCE vulnerabilities'
                ],
                tools: [
                    'curl',
                    'jenkins-cli.jar',
                    'Nmap Jenkins scripts',
                    'Metasploit Jenkins modules',
                    'Burp Suite',
                    'jenkins-attack-framework'
                ]
            },
            {
                id: 'gitlab',
                name: 'Gitlab',
                port: '80,443',
                category: 'web',
                description: 'Web-based DevOps lifecycle tool providing Git repository management.',
                vulnerabilities: [
                    'Authentication bypasses',
                    'SSRF vulnerabilities',
                    'RCE vulnerabilities',
                    'Information disclosure',
                    'Path traversal issues',
                    'Outdated GitLab versions with CVEs'
                ],
                testing: [
                    'Access GitLab: `http://target.com/`',
                    'Check version info: `http://target.com/help`',
                    'Test known CVEs based on version',
                    'Look for sensitive projects with public access',
                    'Check for SSRF vulnerabilities',
                    'Test for authentication bypass'
                ],
                tools: [
                    'curl',
                    'gitlab-tool',
                    'Nmap HTTP scripts',
                    'Metasploit GitLab modules',
                    'Burp Suite',
                    'trufflehog (for secrets in repos)'
                ]
            },
            {
                id: 'jira',
                name: 'Jira',
                port: '8080',
                category: 'web',
                description: 'Issue tracking and project management software.',
                vulnerabilities: [
                    'Information disclosure',
                    'Authentication bypass',
                    'Privilege escalation',
                    'XSS vulnerabilities',
                    'SSRF vulnerabilities',
                    'Outdated Jira versions with CVEs'
                ],
                testing: [
                    'Access Jira: `http://target.com:8080/`',
                    'Check version info: `http://target.com:8080/secure/Dashboard.jspa` (footer)',
                    'Test for user enumeration: `http://target.com:8080/secure/ViewUserHover.jspa?username=admin`',
                    'Check for publicly accessible projects',
                    'Test known CVEs based on version',
                    'Look for sensitive data in issues'
                ],
                tools: [
                    'curl',
                    'jira-scan',
                    'Nmap HTTP scripts',
                    'Metasploit Jira modules',
                    'Burp Suite',
                    'jira-cli'
                ]
            },
            {
                id: 'splunk',
                name: 'Splunk',
                port: '8000,8089',
                category: 'monitoring',
                description: 'Platform for searching, monitoring, and analyzing machine-generated data.',
                vulnerabilities: [
                    'Default credentials',
                    'Remote code execution',
                    'Information disclosure',
                    'Authentication bypass',
                    'SSRF vulnerabilities',
                    'REST API weaknesses'
                ],
                testing: [
                    'Access web interface: `http://target.com:8000/`',
                    'Test REST API: `curl -k https://target.com:8089/services/server/info`',
                    'Check for default credentials: `admin:changeme`',
                    'Test for RCE through custom apps',
                    'Look for sensitive data in indexes',
                    'Check for vulnerable add-ons'
                ],
                tools: [
                    'curl',
                    'splunksploit',
                    'Nmap HTTP scripts',
                    'Metasploit Splunk modules',
                    'Burp Suite',
                    'splunk-sdk'
                ]
            },
            {
                id: 'tomcat',
                name: 'Tomcat',
                port: '8080',
                category: 'web',
                description: 'Open-source web server and servlet container.',
                vulnerabilities: [
                    'Default credentials',
                    'Manager/Host-Manager access',
                    'Weak passwords',
                    'Information disclosure',
                    'WAR file deployment RCE',
                    'Known CVEs in older versions'
                ],
                testing: [
                    'Access Tomcat: `http://target.com:8080/`',
                    'Check manager: `http://target.com:8080/manager/html`',
                    'Test default credentials: `tomcat:tomcat`, `admin:admin`',
                    'Attempt to deploy WAR file if access is gained',
                    'Check for sensitive information in error pages',
                    'Look for version info in HTTP headers'
                ],
                tools: [
                    'curl',
                    'tomcat-brute',
                    'Nmap Tomcat scripts',
                    'Metasploit Tomcat modules',
                    'Burp Suite',
                    'tomcatWarDeployer'
                ]
            },
            {
                id: 'jboss',
                name: 'JBoss/WildFly',
                port: '8080,9990',
                category: 'web',
                description: 'Open-source application server for Java-based applications.',
                vulnerabilities: [
                    'Default credentials',
                    'JMX Console access',
                    'Deserialization vulnerabilities',
                    'Admin console weaknesses',
                    'File upload vulnerabilities',
                    'JMXInvokerServlet RCE'
                ],
                testing: [
                    'Access JBoss: `http://target.com:8080/`',
                    'Check admin console: `http://target.com:9990/console`',
                    'Test JMX Console: `http://target.com:8080/jmx-console/`',
                    'Look for JMXInvokerServlet: `http://target.com:8080/invoker/JMXInvokerServlet`',
                    'Test known deserialization exploits',
                    'Check for default credentials: `admin:admin`'
                ],
                tools: [
                    'curl',
                    'jbossass',
                    'Nmap JBoss scripts',
                    'Metasploit JBoss modules',
                    'Burp Suite',
                    'JexBoss'
                ]
            },
            {
                id: 'weblogic',
                name: 'WebLogic',
                port: '7001,7002',
                category: 'web',
                description: 'Java EE application server from Oracle.',
                vulnerabilities: [
                    'Deserialization vulnerabilities',
                    'Console access',
                    'T3 protocol weaknesses',
                    'XML decoders',
                    'SSRF vulnerabilities',
                    'CVEs in outdated versions'
                ],
                testing: [
                    'Access WebLogic: `http://target.com:7001/console`',
                    'Test for T3 protocol: `nmap --script weblogic-t3-info -p 7001 target.com`',
                    'Check for known deserialization CVEs',
                    'Test default credentials: `weblogic:weblogic`',
                    'Look for WSAT component vulnerabilities',
                    'Test for path traversal in web apps'
                ],
                tools: [
                    'curl',
                    'weblogic-scanner',
                    'Nmap WebLogic scripts',
                    'Metasploit WebLogic modules',
                    'Burp Suite',
                    'WebLogicScan'
                ]
            },
            {
                id: 'websphere',
                name: 'WebSphere',
                port: '9060,9080',
                category: 'web',
                description: 'Java EE application server from IBM.',
                vulnerabilities: [
                    'Admin console access',
                    'Default credentials',
                    'Java deserialization',
                    'SOAP vulnerabilities',
                    'Directory traversal',
                    'Information disclosure'
                ],
                testing: [
                    'Access admin console: `https://target.com:9043/ibm/console/`',
                    'Check for snoop servlet: `http://target.com:9080/snoop`',
                    'Test default credentials: `admin:admin`',
                    'Check for SOAP deserialization vulnerabilities',
                    'Look for sensitive information in error messages',
                    'Test for known CVEs based on version'
                ],
                tools: [
                    'curl',
                    'wsadmin',
                    'Nmap HTTP scripts',
                    'Metasploit WebSphere modules',
                    'Burp Suite',
                    'wascan'
                ]
            },
            {
                id: 'sap',
                name: 'SAP NetWeaver',
                port: '3200,3300,8000',
                category: 'web',
                description: 'Integrated technology platform for SAP applications.',
                vulnerabilities: [
                    'Default accounts',
                    'Gateway vulnerabilities',
                    'ICM vulnerabilities',
                    'SOAP/RFC issues',
                    'Information disclosure',
                    'Authentication bypass'
                ],
                testing: [
                    'Access web interface: `http://target.com:8000/`',
                    'Check for SMDAgents: `http://target.com:8000/sap/monitoring/`',
                    'Test default accounts: `SAP*`, `DDIC`, etc.',
                    'Scan for ICM vulnerabilities',
                    'Look for exposed RFC interfaces',
                    'Check for gateway security issues'
                ],
                tools: [
                    'curl',
                    'sapsploit',
                    'Nmap SAP scripts',
                    'Metasploit SAP modules',
                    'Burp Suite',
                    'PowerSAP'
                ]
            },
            {
                id: 'msmq',
                name: 'MSMQ',
                port: '1801',
                category: 'messaging',
                description: 'Microsoft Message Queuing for application communication.',
                vulnerabilities: [
                    'Unauthenticated access',
                    'Information disclosure',
                    'DoS vulnerabilities',
                    'Default permissions',
                    'Message interception',
                    'Remote code execution'
                ],
                testing: [
                    'Check for MSMQ service: `nmap -p 1801 target.com`',
                    'Connect to MSMQ: `net use \\\\target.com\\private$\\queue`',
                    'Enumerate queues: `msmqutil `',
                    'Check message contents',
                    'Test for remote queue creation',
                    'Look for excessive permissions'
                ],
                tools: [
                    'msmqutil',
                    'Nmap MSMQ scripts',
                    'Metasploit MSMQ modules',
                    'PowerShell MSMQ cmdlets',
                    'QueueExplorer',
                    'msmqtrace'
                ]
            },
            {
                id: 'bgp',
                name: 'BGP',
                port: '179',
                category: 'other',
                description: 'Border Gateway Protocol for routing between autonomous systems on the Internet.',
                vulnerabilities: [
                    'Unauthenticated peers',
                    'Weak authentication',
                    'Route hijacking',
                    'Packet interception',
                    'DoS attacks',
                    'BGP session hijacking'
                ],
                testing: [
                    'Scan for BGP: `nmap -p 179 target.com`',
                    'Check for bogus routes acceptance',
                    'Test for peer authentication',
                    'Look for route filtering issues',
                    'Attempt valid BGP announcements',
                    'Test for maximum prefix limits'
                ],
                tools: [
                    'quagga',
                    'Nmap BGP scripts',
                    'Metasploit BGP modules',
                    'bgpsimple',
                    'bgpcrack',
                    'bgpmon'
                ]
            },
            {
                id: 'dlap',
                name: 'DLAP',
                port: '8001',
                category: 'other',
                description: 'Dell OpenManage Server Administrator protocol.',
                vulnerabilities: [
                    'Information disclosure',
                    'Default credentials',
                    'Authentication bypass',
                    'Command execution',
                    'Session hijacking',
                    'Outdated servers with CVEs'
                ],
                testing: [
                    'Connect to OMSA: `https://target.com:1311/`',
                    'Check for default credentials: `username: root, password: calvin`',
                    'Look for sensitive information in web interface',
                    'Test for command execution in diagnostic features',
                    'Check for authentication bypass vulnerabilities',
                    'Scan for known CVEs in reported version'
                ],
                tools: [
                    'curl',
                    'Nmap HTTPS scripts',
                    'Metasploit modules for OMSA',
                    'Burp Suite',
                    'racadm',
                    'OMSA CLI'
                ]
            },
            {
                id: 'esxi',
                name: 'VMware ESXi',
                port: '443,902',
                category: 'other',
                description: 'Bare-metal hypervisor for virtual machines.',
                vulnerabilities: [
                    'Default credentials',
                    'Authentication bypass',
                    'Outdated ESXi with CVEs',
                    'Virtual machine escapes',
                    'VMSA vulnerabilities',
                    'Information disclosure'
                ],
                testing: [
                    'Access ESXi web interface: `https://target.com/`',
                    'Test default credentials: `root:vmware`',
                    'Check for ESXi version and patch level',
                    'Look for known CVEs based on version',
                    'Test for authentication bypass vulnerabilities',
                    'Attempt VM console access'
                ],
                tools: [
                    'curl',
                    'Nmap HTTPS scripts',
                    'Metasploit ESXi modules',
                    'VMware vSphere client',
                    'PowerCLI',
                    'vmware-exploits'
                ]
            },
            {
                id: 'vcenter',
                name: 'vCenter',
                port: '443,9443',
                category: 'other',
                description: 'Centralized management application for VMware vSphere environments.',
                vulnerabilities: [
                    'Default credentials',
                    'VMSA vulnerabilities',
                    'Authentication bypass',
                    'Information disclosure',
                    'SSRF vulnerabilities',
                    'Remote code execution'
                ],
                testing: [
                    'Access vCenter: `https://target.com/`',
                    'Test default credentials: `administrator@vsphere.local:vmware`',
                    'Check for vCenter version and patch level',
                    'Look for known CVEs based on version',
                    'Test for authentication bypass vulnerabilities',
                    'Attempt SSRF through vCenter interfaces'
                ],
                tools: [
                    'curl',
                    'Nmap HTTPS scripts',
                    'Metasploit vCenter modules',
                    'VMware vSphere client',
                    'PowerCLI',
                    'vcenter-scanner'
                ]
            },
            {
                id: 'activedirectory',
                name: 'Active Directory',
                port: '389,3268',
                category: 'directory',
                description: 'Directory service by Microsoft for Windows domain networks.',
                vulnerabilities: [
                    'Kerberoasting',
                    'AS-REP Roasting',
                    'LDAP relay attacks',
                    'Insecure LDAP configurations',
                    'Password spraying',
                    'DCSync attacks',
                    'Domain privilege escalation'
                ],
                testing: [
                    'Enumerate users: `ldapsearch -x -h target.com -b "dc=domain,dc=com" "objectClass=user"`',
                    'Password spraying: `crackmapexec smb target.com -u users.txt -p Winter2020`',
                    'Kerberoasting: `GetUserSPNs.py domain.com/user:password -request`',
                    'AS-REP Roasting: `GetNPUsers.py domain.com/ -usersfile users.txt -format hashcat`',
                    'Check for LDAP signing and channel binding',
                    'Test for DCSync permissions'
                ],
                tools: [
                    'Bloodhound',
                    'Impacket suite',
                    'CrackMapExec',
                    'PowerView/PowerSploit',
                    'Mimikatz',
                    'ldapsearch',
                    'Rubeus'
                ]
            },
            {
                id: 'nosql',
                name: 'NoSQL Databases',
                port: 'various',
                category: 'database',
                description: 'Various database systems that use non-relational data structures.',
                vulnerabilities: [
                    'NoSQL injection',
                    'Unauthenticated access',
                    'Weak credentials',
                    'Excessive permissions',
                    'Information disclosure',
                    'Insecure defaults'
                ],
                testing: [
                    'Test for NoSQL injection in web apps',
                    'Check for exposed database interfaces',
                    'Attempt unauthenticated access',
                    'Look for default credentials',
                    'Enumerate databases and collections',
                    'Test for excessive permissions on data'
                ],
                tools: [
                    'NoSQLMap',
                    'nosqlclient',
                    'Burp Suite',
                    'MongoDB Compass',
                    'redis-cli',
                    'casstorm',
                    'NoSQL exploitation frameworks'
                ]
            },
            {
                id: 'aws',
                name: 'AWS Services',
                port: 'various',
                category: 'other',
                description: 'Amazon Web Services cloud computing services.',
                vulnerabilities: [
                    'Exposed access keys',
                    'Misconfigured S3 buckets',
                    'Excessive IAM permissions',
                    'Public RDS instances',
                    'Unprotected Lambda functions',
                    'API Gateway weaknesses'
                ],
                testing: [
                    'Check for exposed S3 buckets: `aws s3 ls s3://bucketname --no-sign-request`',
                    'Test for public EC2 snapshots',
                    'Look for exposed keys in public repositories',
                    'Scan for weak IAM policies',
                    'Check for public RDS instances',
                    'Test API Gateway endpoints'
                ],
                tools: [
                    'AWS CLI',
                    'Pacu',
                    'ScoutSuite',
                    'CloudSploit',
                    'S3Scanner',
                    'AWSBucketDump',
                    'prowler'
                ]
            },
            {
                id: 'azure',
                name: 'Azure Services',
                port: 'various',
                category: 'other',
                description: 'Microsoft Azure cloud computing services.',
                vulnerabilities: [
                    'Storage account misconfigurations',
                    'Service principal weaknesses',
                    'Insecure key vault access',
                    'Excessive Azure AD permissions',
                    'Public blob containers',
                    'Function app vulnerabilities'
                ],
                testing: [
                    'Check for public blob storage: `az storage blob list --account-name accountname --container-name containername --auth-mode login`',
                    'Test for unauthenticated function apps',
                    'Look for excessive permissions in service principals',
                    'Scan for misconfigured key vaults',
                    'Check for public Azure SQL databases',
                    'Test Azure AD configuration'
                ],
                tools: [
                    'Azure CLI',
                    'MicroBurst',
                    'Stormspotter',
                    'AzureHound',
                    'Azurite',
                    'ScoutSuite',
                    'Burp Suite'
                ]
            },
			{
  id: 'echo',
  name: 'Echo',
  port: '7',
  category: 'other',
  description: 'A simple service that echoes back any data sent to it, used for testing network connectivity. ',
  vulnerabilities: [
    'Potential for amplification attacks',
    'Information leakage',
    'DoS vulnerabilities',
    'Service fingerprinting',
    'Legacy service with minimal security'
  ],
  testing: [
    'Connect using netcat: `nc target.com 7`',
    'Send data and verify it echoes back',
    'Check for response data leakage',
    'Attempt to use for network scanning techniques',
    'Test for DoS conditions via repeated connections'
  ],
  tools: [
    'netcat/nc',
    'telnet',
    'echoping',
    'Nmap echo scripts',
    'Custom echo testing tools'
  ]
},

// JDWP
{
  id: 'jdwp',
  name: 'JDWP',
  port: 'various',
  category: 'other',
  description: 'Java Debug Wire Protocol used for communication between a debugger and Java virtual machine (JVM). ',
  vulnerabilities: [
    'Remote code execution',
    'Unauthenticated access',
    'Information disclosure',
    'Debugging features left enabled in production',
    'Access to sensitive application data'
  ],
  testing: [
    'Scan for JDWP ports: `nmap -sT -p- target.com`',
    'Test for unauthenticated access: `jdb -attach target.com:port`',
    'Attempt remote code execution: `jdwp-shellifier.py -t target.com -p port`',
    'Extract sensitive information from memory',
    'Check for exposed debugging interfaces in web applications'
  ],
  tools: [
    'jdb (Java Debugger)',
    'jdwp-shellifier',
    'Metasploit JDWP modules',
    'JDWP-Handshake',
    'Nmap NSE scripts'
  ]
},

// Printer Services
{
  id: 'printers',
  name: 'Printer Services',
  port: '9100,515,631',
  category: 'other',
  description: 'Various printer services including RAW printing (9100), LPD (515), and IPP (631) used for print job management. ',
  vulnerabilities: [
    'Default credentials',
    'Unauthenticated access to job/printer management',
    'Information disclosure',
    'Print job interception',
    'Firmware vulnerabilities',
    'Cross-site printing attacks'
  ],
  testing: [
    'Enumerate printers: `nmap -p 9100,515,631 target.com --script printer-info`',
    'Test for default credentials',
    'Access printer web interface: `http://target.com:631/`',
    'Attempt to view or modify print queues',
    'Check for sensitive data in stored print jobs',
    'Test for printer firmware vulnerabilities'
  ],
  tools: [
    'PRET (Printer Exploitation Toolkit)',
    'Nmap printer scripts',
    'IPP tools',
    'CUPS browser interface',
    'Praeda',
    'SNMP tools for printer enumeration'
  ]
},

// WHOIS
{
  id: 'whois',
  name: 'WHOIS',
  port: '43',
  category: 'other',
  description: 'Protocol for querying databases containing domain registration information. ',
  vulnerabilities: [
    'Information disclosure',
    'Rogue WHOIS server exploits',
    'Rate limiting bypass',
    'WHOIS data harvesting',
    'Input validation issues'
  ],
  testing: [
    'Connect to WHOIS server: `nc target.com 43`',
    'Query for domains: enter a domain name',
    'Test for information leakage',
    'Check for rate limiting',
    'Test input validation with special characters'
  ],
  tools: [
    'whois client',
    'netcat/nc',
    'Nmap whois scripts',
    'Commercial WHOIS harvesters',
    'Custom WHOIS query tools'
  ]
},

// Finger
{
  id: 'finger',
  name: 'Finger',
  port: '79',
  category: 'other',
  description: 'Protocol for retrieving information about users on a remote system. ',
  vulnerabilities: [
    'User enumeration',
    'Information disclosure',
    'System information leakage',
    'Command execution in some implementations',
    'Buffer overflow vulnerabilities'
  ],
  testing: [
    'Query all users: `finger @target.com`',
    'Query specific user: `finger user@target.com`',
    'Attempt username enumeration',
    'Test for command injection: `finger "|/bin/ls -la"@target.com`',
    'Look for leaked system information'
  ],
  tools: [
    'finger client',
    'Metasploit finger modules',
    'Nmap finger scripts',
    'Custom finger enumeration scripts',
    'netcat/nc'
  ]
},

// Portmapper
{
  id: 'portmapper',
  name: 'Portmapper',
  port: '111',
  category: 'other',
  description: 'Service for mapping RPC program numbers to network port numbers on Unix-like systems. ',
  vulnerabilities: [
    'Information disclosure',
    'RPC service enumeration',
    'Potential for RPC-based attacks',
    'Port redirection attacks',
    'DoS vulnerabilities'
  ],
  testing: [
    'List RPC services: `rpcinfo -p target.com`',
    'Dump RPC statistics: `rpcinfo -s target.com`',
    'Scan for RPC vulnerabilities: `nmap -sV -p 111 --script=rpc* target.com`',
    'Check for null sessions and unauthorized access',
    'Test for portmap amplification attack potential'
  ],
  tools: [
    'rpcinfo',
    'rpcbind',
    'Nmap RPC scripts',
    'Metasploit RPC modules',
    'rpcdump (Impacket)'
  ]
},

// Ident
{
  id: 'ident',
  name: 'Ident',
  port: '113',
  category: 'other',
  description: 'Protocol that helps identify the username of a client connecting to a server. ',
  vulnerabilities: [
    'User enumeration',
    'Information disclosure',
    'OS fingerprinting',
    'Service mapping',
    'Account validation'
  ],
  testing: [
    'Query ident service: `nc target.com 113`',
    'Send port query: `echo "12345, 80" | nc target.com 113`',
    'Enumerate users with established connections',
    'Map services to users',
    'Collect OS and service information'
  ],
  tools: [
    'ident-user-enum',
    'netcat/nc',
    'Nmap ident scripts',
    'Metasploit ident modules',
    'Custom ident query tools'
  ]
},

// NTP
{
  id: 'ntp',
  name: 'NTP',
  port: '123',
  category: 'other',
  description: 'Network Time Protocol used for clock synchronization between computer systems. ',
  vulnerabilities: [
    'NTP amplification attacks',
    'Information disclosure',
    'Denial of service',
    'Authentication issues',
    'Monlist command abuse',
    'Time shifting attacks'
  ],
  testing: [
    'Query NTP server: `ntpq -c peers target.com`',
    'Check for monlist: `ntpdc -n -c monlist target.com`',
    'Test for NTP version: `nmap -sU -p 123 --script ntp-info target.com`',
    'Check for NTP amplification potential',
    'Test for authentication bypass'
  ],
  tools: [
    'ntpq',
    'ntpdc',
    'Nmap NTP scripts',
    'Metasploit NTP modules',
    'ntpdate',
    'NTPRecon'
  ]
},

// Check Point FireWall-1
{
  id: 'checkpoint',
  name: 'CheckPoint FireWall-1',
  port: '264',
  category: 'other',
  description: 'Check Point FireWall-1 management protocol. ',
  vulnerabilities: [
    'Unauthenticated information disclosure',
    'Management interface vulnerabilities',
    'Default or weak credentials',
    'Outdated firewall versions',
    'Authentication bypass issues'
  ],
  testing: [
    'Identify Check Point services: `nmap -p 264 target.com`',
    'Test for information disclosure',
    'Check for management interface access',
    'Attempt to determine firewall version',
    'Test for known CVEs based on version'
  ],
  tools: [
    'Nmap Check Point scripts',
    'Metasploit Check Point modules',
    'FW1-tool',
    'cpmap',
    'Custom Check Point probing tools'
  ]
},

// Modbus
{
  id: 'modbus',
  name: 'Modbus',
  port: '502',
  category: 'other',
  description: 'Serial communications protocol for use with programmable logic controllers (PLCs). ',
  vulnerabilities: [
    'No authentication by design',
    'No encryption',
    'Command spoofing',
    'Function code scanning',
    'Unauthorized control of industrial systems',
    'Information disclosure'
  ],
  testing: [
    'Discover Modbus devices: `nmap -p 502 target.com`',
    'Enumerate Modbus IDs: `nmap --script modbus-discover target.com`',
    'Read coils/registers: `modpoll -m tcp -a [slave ID] -r [register] -c [count] target.com`',
    'Test for unauthorized write access to coils/registers',
    'Check for Modbus function code support'
  ],
  tools: [
    'modpoll',
    'Nmap Modbus scripts',
    'Metasploit Modbus modules',
    'ModbusPal',
    'Modbus-cli',
    'Smod framework'
  ]
},

// Rexec
{
  id: 'rexec',
  name: 'Rexec',
  port: '512',
  category: 'remote',
  description: 'Remote execution service that allows users to run commands on remote hosts. ',
  vulnerabilities: [
    'Clear-text authentication',
    'Weak authentication methods',
    'No encryption',
    'Command injection',
    'Brute force attacks'
  ],
  testing: [
    'Connect to rexec: `rexec target.com -l username command`',
    'Attempt to execute commands',
    'Try unauthenticated or weak credential access',
    'Monitor for clear-text credentials',
    'Test for command injection'
  ],
  tools: [
    'rexec client',
    'netcat/nc',
    'Nmap rexec scripts',
    'Metasploit rexec modules',
    'Hydra (for brute forcing)'
  ]
},

// Rlogin
{
  id: 'rlogin',
  name: 'Rlogin',
  port: '513',
  category: 'remote',
  description: 'Remote login service that allows users to log in to a remote host. ',
  vulnerabilities: [
    'Trust relationship exploitation',
    'Clear-text transmission',
    'Authentication bypass',
    'IP spoofing',
    'Remote command execution'
  ],
  testing: [
    'Connect to rlogin: `rlogin -l username target.com`',
    'Test for trusted hosts: `rlogin target.com`',
    'Check for unauthenticated access',
    'Attempt to bypass authentication',
    'Monitor for clear-text credentials'
  ],
  tools: [
    'rlogin client',
    'netcat/nc',
    'Nmap rlogin scripts',
    'Metasploit rlogin modules',
    'Hydra (for brute forcing)'
  ]
},

// Rsh
{
  id: 'rsh',
  name: 'Rsh',
  port: '514',
  category: 'remote',
  description: 'Remote shell service that executes commands on a remote host without requiring a password. ',
  vulnerabilities: [
    'Trust exploitation',
    'Lack of encryption',
    'Authentication bypasses',
    'IP spoofing vulnerabilities',
    'Command injection'
  ],
  testing: [
    'Connect to rsh: `rsh target.com -l username command`',
    'Test for trusted hosts',
    'Attempt to execute commands without authentication',
    'Check for rhosts files',
    'Test IP spoofing techniques'
  ],
  tools: [
    'rsh client',
    'netcat/nc',
    'Nmap rsh scripts',
    'Metasploit rsh modules',
    'Custom rsh testing tools'
  ]
},

// LPD
{
  id: 'lpd',
  name: 'LPD',
  port: '515',
  category: 'other',
  description: 'Line Printer Daemon protocol used for printer queue management. ',
  vulnerabilities: [
    'Unauthorized access to printer queues',
    'Information disclosure',
    'Print job interception',
    'Buffer overflow vulnerabilities',
    'Format string vulnerabilities'
  ],
  testing: [
    'Connect to LPD: `nc target.com 515`',
    'List printer queues: `lpq -P printer_name -h target.com`',
    'Submit test print job: `lpr -P printer_name -h target.com file.txt`',
    'Attempt to view other print jobs',
    'Test for command injection through print jobs'
  ],
  tools: [
    'lpq/lpr/lprm',
    'netcat/nc',
    'Nmap LPD scripts',
    'Metasploit LPD modules',
    'PRET (Printer Exploitation Toolkit)'
  ]
},

// AFP
{
  id: 'afp',
  name: 'AFP',
  port: '548',
  category: 'file',
  description: 'Apple Filing Protocol used for file services on Apple networks. ',
  vulnerabilities: [
    'Authentication bypass',
    'Information disclosure',
    'Weak authentication',
    'Brute force vulnerabilities',
    'Unauthorized access to file shares'
  ],
  testing: [
    'Connect to AFP: `afpcmd target.com`',
    'List AFP shares: `showmount -e target.com`',
    'Attempt anonymous access: `mount_afp afp://target.com/share /mnt/afp`',
    'Brute force credentials: `hydra -L users.txt -P passwords.txt afp://target.com`',
    'Check for sensitive data on accessible shares'
  ],
  tools: [
    'afpfs-ng',
    'mount_afp',
    'Nmap AFP scripts',
    'Metasploit AFP modules',
    'Hydra (for brute forcing)'
  ]
},

// Internet Printing Protocol
{
  id: 'ipp',
  name: 'IPP',
  port: '631',
  category: 'other',
  description: 'Internet Printing Protocol used for managing network printers and print jobs. ',
  vulnerabilities: [
    'Default credentials',
    'Information disclosure',
    'Cross-site printing',
    'Print job manipulation',
    'Server-side request forgery (SSRF)'
  ],
  testing: [
    'Access the web interface: `http://target.com:631/`',
    'Enumerate printers: `ipptool -tv target.com:631 get-printers.test`',
    'Test for default credentials',
    'Check for information leakage',
    'Test for SSRF via IPP redirection'
  ],
  tools: [
    'ipptool',
    'CUPS browser interface',
    'Nmap IPP scripts',
    'PRET (Printer Exploitation Toolkit)',
    'Burp Suite (for web interface testing)'
  ]
},

// Rusersd
{
  id: 'rusersd',
  name: 'Rusersd',
  port: '1026',
  category: 'other',
  description: 'Remote users service daemon that provides information about users logged into a system. ',
  vulnerabilities: [
    'User enumeration',
    'Information disclosure',
    'System enumeration',
    'System information leakage',
    'RPC vulnerabilities'
  ],
  testing: [
    'Query users: `rusers target.com`',
    'Check detailed user info: `rusers -l target.com`',
    'Enumerate through RPC: `rpcinfo -p target.com | grep rusersd`',
    'Test for information disclosure',
    'Look for system details in responses'
  ],
  tools: [
    'rusers',
    'rpcinfo',
    'Nmap RPC scripts',
    'Metasploit RPC modules',
    'Custom RPC query tools'
  ]
},

// Socks
{
  id: 'socks',
  name: 'Socks',
  port: '1080',
  category: 'other',
  description: 'Protocol for handling traffic through a proxy server. ',
  vulnerabilities: [
    'Unauthenticated access',
    'Weak authentication',
    'Open proxy vulnerabilities',
    'Information leakage',
    'Proxy abuse for attacks'
  ],
  testing: [
    'Test proxy connection: `nc -v target.com 1080`',
    'Check for open proxy: `proxychains nmap scanme.nmap.org`',
    'Attempt to use proxy without authentication',
    'Verify proxy filtering rules',
    'Test for data leakage through proxy'
  ],
  tools: [
    'proxychains',
    'socat',
    'Nmap proxy scripts',
    'Metasploit proxy modules',
    'SOCKS proxy testing tools',
    'ProxyTester'
  ]
},

// Java RMI
{
  id: 'java_rmi',
  name: 'Java RMI',
  port: '1098,1099,1050',
  category: 'other',
  description: 'Remote Method Invocation protocol that enables Java objects to invoke methods on remote objects. ',
  vulnerabilities: [
    'Insecure deserialization',
    'Remote code execution',
    'Unauthenticated access',
    'Registry enumeration',
    'Information disclosure'
  ],
  testing: [
    'Enumerate RMI registry: `nmap -p 1099 --script rmi-dumpregistry target.com`',
    'Check for unauthenticated access',
    'Test for deserialization vulnerabilities: `java -jar ysoserial.jar CommonsCollections1 "command" | rmiscout tcp://target.com:1099/`',
    'Attempt to call remote methods without authentication',
    'Look for exposed sensitive methods'
  ],
  tools: [
    'rmiscout',
    'ysoserial',
    'BaRMIe',
    'Nmap RMI scripts',
    'Metasploit RMI modules',
    'rmiregistry'
  ]
},

// MQTT
{
  id: 'mqtt',
  name: 'MQTT',
  port: '1883',
  category: 'messaging',
  description: 'Message Queue Telemetry Transport protocol for lightweight messaging between IoT devices. ',
  vulnerabilities: [
    'Lack of authentication',
    'Unencrypted communications',
    'Topic enumeration',
    'Information disclosure',
    'Unauthorized publish/subscribe'
  ],
  testing: [
    'Connect to broker: `mosquitto_sub -h target.com -t "#" -v`',
    'Attempt to subscribe to all topics: `mosquitto_sub -h target.com -t "#" -v`',
    'Test publishing to topics: `mosquitto_pub -h target.com -t "test" -m "test"`',
    'Check for authentication',
    'Test TLS implementation'
  ],
  tools: [
    'mosquitto_sub/mosquitto_pub',
    'MQTT-PWN',
    'MQTT Explorer',
    'Nmap MQTT scripts',
    'Metasploit MQTT modules'
  ]
},

// Compaq/HP Insight Manager
{
  id: 'hp_insight',
  name: 'HP Insight Manager',
  port: '2301,2381',
  category: 'other',
  description: 'Systems management software for monitoring HP servers and storage. ',
  vulnerabilities: [
    'Default credentials',
    'Information disclosure',
    'Authentication bypass',
    'Command execution',
    'Outdated software with CVEs'
  ],
  testing: [
    'Access web interface: `https://target.com:2381/`',
    'Test default credentials',
    'Enumerate version information',
    'Check for known vulnerabilities based on version',
    'Test for command execution through management features'
  ],
  tools: [
    'Web browser',
    'Nmap HTTP scripts',
    'Metasploit HP Insight modules',
    'Burp Suite',
    'Curl/wget'
  ]
},

// Squid
{
  id: 'squid',
  name: 'Squid',
  port: '3128',
  category: 'other',
  description: 'Proxy and cache server for HTTP, HTTPS, and FTP. ',
  vulnerabilities: [
    'Misconfigured access controls',
    'Information disclosure',
    'Cache poisoning',
    'SSRF through proxy',
    'Open proxy vulnerabilities'
  ],
  testing: [
    'Test proxy access: `curl -x target.com:3128 http://example.com`',
    'Check cache poisoning: `curl -x target.com:3128 -H "X-Cache-Bypass: true" http://example.com`',
    'Test for SSRF: `curl -x target.com:3128 http://internal-network/`',
    'Verify access controls',
    'Check for version information'
  ],
  tools: [
    'curl',
    'proxychains',
    'Burp Suite',
    'Nmap proxy scripts',
    'Metasploit Squid modules',
    'proxytunnel'
  ]
},

// ISCSI
{
  id: 'iscsi',
  name: 'ISCSI',
  port: '3260',
  category: 'storage',
  description: 'Internet Small Computer Systems Interface protocol for storage networking. ',
  vulnerabilities: [
    'Authentication weaknesses',
    'CHAP bypass',
    'Unauthenticated access',
    'Information disclosure',
    'Target enumeration'
  ],
  testing: [
    'Discover iSCSI targets: `iscsiadm -m discovery -t sendtargets -p target.com`',
    'Attempt to connect to targets: `iscsiadm -m node -T iqn.target -p target.com --login`',
    'Test for authentication bypass',
    'Check for unauthenticated access',
    'Test for information disclosure in target responses'
  ],
  tools: [
    'iscsiadm',
    'open-iscsi',
    'Nmap iSCSI scripts',
    'Metasploit iSCSI modules',
    'scamper'
  ]
},

// SAPRouter
{
  id: 'saprouter',
  name: 'SAPRouter',
  port: '3299',
  category: 'other',
  description: 'Proxy component for SAP systems that controls connections between SAP systems. ',
  vulnerabilities: [
    'Misconfigured route permissions',
    'Information disclosure',
    'Authentication bypass',
    'Weak ACL configurations',
    'Routing table manipulation'
  ],
  testing: [
    'Test SAPRouter: `saprouter -r -H target.com -S port`',
    'Enumerate SAP services: `nmap -p 3299 --script sap-router-info target.com`',
    'Check for route permissions',
    'Attempt to connect to backend systems',
    'Test for information disclosure'
  ],
  tools: [
    'SAPRouter utilities',
    'Nmap SAP scripts',
    'Metasploit SAP modules',
    'PowerSAP',
    'SAProuter-GrabRoutingTable'
  ]
},

// distcc
{
  id: 'distcc',
  name: 'distcc',
  port: '3632',
  category: 'other',
  description: 'Distributed compiler service for C/C++ that allows compilation tasks to be shared across machines. ',
  vulnerabilities: [
    'Remote code execution',
    'Authentication bypass',
    'Unauthenticated access',
    'Command injection',
    'Information disclosure'
  ],
  testing: [
    'Scan for distcc: `nmap -p 3632 target.com`',
    'Test for RCE: `nmap -p 3632 --script distcc-cve2004-2687 target.com`',
    'Attempt to execute commands: `distcc command`',
    'Check for authentication mechanisms',
    'Test for command injection'
  ],
  tools: [
    'distcc client',
    'Nmap distcc scripts',
    'Metasploit distcc modules',
    'netcat/nc',
    'Custom distcc exploit tools'
  ]
},

// Subversion
{
  id: 'svn',
  name: 'Subversion',
  port: '3690',
  category: 'other',
  description: 'Version control system for source code management. ',
  vulnerabilities: [
    'Information disclosure',
    'Weak authentication',
    'Repository access control issues',
    'Cleartext credentials',
    'Outdated SVN servers with CVEs'
  ],
  testing: [
    'List repository: `svn list svn://target.com`',
    'Check for anonymous access: `svn info svn://target.com`',
    'Download repository: `svn checkout svn://target.com`',
    'Test for sensitive information in commit history',
    'Look for credentials in repository data'
  ],
  tools: [
    'svn client',
    'svnrdump',
    'Nmap SVN scripts',
    'Metasploit SVN modules',
    'svnscan'
  ]
},

// WS-Discovery
{
  id: 'wsd',
  name: 'WS-Discovery',
  port: '3702',
  category: 'other',
  description: 'Web Services Dynamic Discovery protocol for locating services on a local network. ',
  vulnerabilities: [
    'Information disclosure',
    'Service enumeration',
    'DDoS amplification',
    'Reconnaissance potential',
    'Unauthenticated access'
  ],
  testing: [
    'Discover services: `nmap -p 3702 --script broadcast-ws-discovery target.com`',
    'Collect endpoint information',
    'Test for amplification DDoS potential',
    'Check for information leakage in responses',
    'Analyze device/service characteristics'
  ],
  tools: [
    'ws-discovery',
    'Nmap WS-Discovery scripts',
    'wsdd client',
    'Wireshark with WS-Discovery filters',
    'Custom WS-Discovery probes'
  ]
},

// Erlang Port Mapper Daemon
{
  id: 'epmd',
  name: 'Erlang Port Mapper',
  port: '4369',
  category: 'other',
  description: 'Service for mapping Erlang node names to IP addresses and port numbers. ',
  vulnerabilities: [
    'Information disclosure',
    'Node enumeration',
    'Unauthorized node access',
    'RCE via Erlang node hijacking',
    'Cookie authentication issues'
  ],
  testing: [
    'List Erlang nodes: `epmd -names`',
    'Connect to nodes: `erl -name test@attacker.com -setcookie cookie -remsh target@target.com`',
    'Enumerate node information',
    'Test for cookie authentication bypass',
    'Attempt to execute commands on nodes'
  ],
  tools: [
    'epmd',
    'erl',
    'Nmap epmd scripts',
    'Metasploit Erlang modules',
    'erlang-cookie-stealer'
  ]
},

// Cisco Smart Install
{
  id: 'cisco_smart_install',
  name: 'Cisco Smart Install',
  port: '4786',
  category: 'other',
  description: 'Cisco feature for zero-touch deployment of new switches. ',
  vulnerabilities: [
    'Unauthenticated configuration access',
    'Remote code execution',
    'Configuration download',
    'File system access',
    'MITM attacks'
  ],
  testing: [
    'Check for Smart Install: `nmap -p 4786 -sV target.com`',
    'Test for configuration access: `cisco-smart-install-client --host target.com --get-config`',
    'Attempt to modify configuration',
    'Check for file system access',
    'Test for code execution vulnerabilities'
  ],
  tools: [
    'cisco-smart-install-client',
    'Nmap Cisco scripts',
    'Metasploit Cisco modules',
    'SIET (Smart Install Exploitation Tool)',
    'Cisco SmartInstallExploit'
  ]
},

// Docker Registry
{
  id: 'docker_registry',
  name: 'Docker Registry',
  port: '5000',
  category: 'other',
  description: 'Storage and distribution system for Docker images. ',
  vulnerabilities: [
    'Unauthenticated access',
    'Weak authentication',
    'Information disclosure',
    'Image enumeration',
    'Sensitive data in images'
  ],
  testing: [
    'List registries: `curl -X GET http://target.com:5000/v2/`',
    'Enumerate images: `curl -X GET http://target.com:5000/v2/_catalog`',
    'List image tags: `curl -X GET http://target.com:5000/v2/image_name/tags/list`',
    'Download image layers to inspect for secrets',
    'Test for authentication bypass'
  ],
  tools: [
    'curl',
    'docker client',
    'registry-cli',
    'Nmap HTTP scripts',
    'Burp Suite',
    'regxy'
  ]
},

// mDNS/DNS-SD
{
  id: 'mdns',
  name: 'mDNS/DNS-SD',
  port: '5353',
  category: 'other',
  description: 'Multicast DNS and DNS Service Discovery protocols for zero-configuration networking. ',
  vulnerabilities: [
    'Information disclosure',
    'Service enumeration',
    'Spoofing attacks',
    'Amplification attacks',
    'Device fingerprinting'
  ],
  testing: [
    'Discover services: `avahi-browse -a`',
    'Query specific service: `avahi-browse -r -t _http._tcp`',
    'Test for mDNS amplification potential',
    'Attempt service spoofing',
    'Collect device information from responses'
  ],
  tools: [
    'avahi-browse',
    'avahi-discover',
    'mdns-scan',
    'Nmap mDNS scripts',
    'Metasploit mDNS modules',
    'Wireshark with mDNS filters'
  ]
},

// Redshift
{
  id: 'redshift',
  name: 'Redshift',
  port: '5439',
  category: 'database',
  description: 'Amazon Redshift data warehouse service, based on PostgreSQL. ',
  vulnerabilities: [
    'Weak credentials',
    'Information disclosure',
    'Excessive privileges',
    'Authentication bypass',
    'SQL injection in applications'
  ],
  testing: [
    'Connect to Redshift: `psql -h target.com -p 5439 -U username -d database`',
    'Test for weak credentials',
    'Check for public access',
    'Enumerate database permissions',
    'Look for sensitive data'
  ],
  tools: [
    'psql client',
    'Nmap PostgreSQL scripts',
    'Metasploit PostgreSQL modules',
    'sqlmap',
    'AWS CLI',
    'Redshift-specific tools'
  ]
},

// Android Debug Bridge
{
  id: 'adb',
  name: 'Android Debug Bridge',
  port: '5555',
  category: 'other',
  description: 'Command-line tool for Android devices that allows for debugging capabilities. ',
  vulnerabilities: [
    'Unauthenticated access',
    'Remote code execution',
    'Data extraction',
    'Screen capture',
    'Malware installation'
  ],
  testing: [
    'Connect to ADB: `adb connect target.com:5555`',
    'List devices: `adb devices`',
    'Execute commands: `adb shell "command"`',
    'Pull data: `adb pull /data/path/to/file`',
    'Install applications: `adb install app.apk`'
  ],
  tools: [
    'adb client',
    'Nmap ADB scripts',
    'Metasploit ADB modules',
    'adbsploit',
    'ADBreak',
    'ADB-Toolkit'
  ]
},

// Kibana
{
  id: 'kibana',
  name: 'Kibana',
  port: '5601',
  category: 'other',
  description: 'Data visualization dashboard for Elasticsearch. ',
  vulnerabilities: [
    'Unauthenticated access',
    'Local file inclusion',
    'Cross-site scripting',
    'Insecure API endpoints',
    'Outdated versions with CVEs'
  ],
  testing: [
    'Access Kibana interface: `http://target.com:5601/`',
    'Check for unauthenticated access',
    'Test for LFI: `http://target.com:5601/api/console/api_server?sense_version=@@SENSE_VERSION&apis=../../../../../../etc/passwd`',
    'Enumerate Elasticsearch indices',
    'Check for outdated versions with known vulnerabilities'
  ],
  tools: [
    'Web browser',
    'curl',
    'Burp Suite',
    'Nmap HTTP scripts',
    'Metasploit Kibana modules',
    'Kibana exploit tools'
  ]
},

// AMQP
{
  id: 'amqp',
  name: 'AMQP',
  port: '5671,5672',
  category: 'messaging',
  description: 'Advanced Message Queuing Protocol used for message-oriented middleware. ',
  vulnerabilities: [
    'Default credentials',
    'Unauthenticated access',
    'Information disclosure',
    'Message interception',
    'Weak authentication'
  ],
  testing: [
    'Connect to AMQP: `amqp-client target.com 5672`',
    'Test for default credentials',
    'Enumerate exchanges and queues',
    'Attempt to publish/consume messages',
    'Check for TLS implementation'
  ],
  tools: [
    'amqp-client',
    'amqp-tools',
    'Nmap AMQP scripts',
    'Metasploit AMQP modules',
    'RabbitMQ management interface'
  ]
},

// Apache JServ Protocol
{
  id: 'ajp',
  name: 'AJP',
  port: '8009',
  category: 'web',
  description: 'Apache JServ Protocol used for communication between a web server and application server. ',
  vulnerabilities: [
    'Ghostcat (CVE-2020-1938)',
    'Information disclosure',
    'Request forgery',
    'Unauthenticated access',
    'Remote file reading'
  ],
  testing: [
    'Scan for AJP: `nmap -p 8009 --script ajp-methods target.com`',
    'Test for Ghostcat vulnerability: `ajpShooter.py http://target.com:8080/ 8009 /WEB-INF/web.xml read`',
    'Check for information disclosure',
    'Attempt to read sensitive files',
    'Test for request forgery'
  ],
  tools: [
    'ajpShooter',
    'Nmap AJP scripts',
    'Metasploit AJP modules',
    'ajp-proxy',
    'TomcatWarDeployer',
    'ajp_request'
  ]
},

// InfluxDB
{
  id: 'influxdb',
  name: 'InfluxDB',
  port: '8086',
  category: 'database',
  description: 'Time series database for storing and analyzing time-based data. ',
  vulnerabilities: [
    'Default credentials',
    'Authentication bypass',
    'Information disclosure',
    'Insecure web interfaces',
    'JWT token vulnerabilities',
    'Privilege escalation'
  ],
  testing: [
    'Connect to InfluxDB: `curl -G http://target.com:8086/query --data-urlencode "q=SHOW DATABASES"`',
    'Test for default credentials',
    'Check authentication: `curl -G http://target.com:8086/query -u admin:admin --data-urlencode "q=SHOW DATABASES"`',
    'Test for JWT token vulnerabilities',
    'Enumerate users and databases'
  ],
  tools: [
    'curl',
    'influx client',
    'Nmap HTTP scripts',
    'Metasploit InfluxDB modules',
    'Burp Suite',
    'InfluxDB web UI'
  ]
},

// Splunkd
{
  id: 'splunkd',
  name: 'Splunkd',
  port: '8089',
  category: 'other',
  description: 'Management service for Splunk data collection and analysis platform. ',
  vulnerabilities: [
    'Default credentials',
    'Authentication bypass',
    'Information disclosure',
    'Remote code execution',
    'Insecure REST APIs'
  ],
  testing: [
    'Access Splunkd: `curl -k https://target.com:8089/services`',
    'Test default credentials: `curl -k -u admin:changeme https://target.com:8089/services`',
    'Enumerate Splunk apps: `curl -k -u username:password https://target.com:8089/services/apps/local`',
    'Test for RCE through apps',
    'Check for information disclosure'
  ],
  tools: [
    'curl',
    'Nmap HTTP scripts',
    'Metasploit Splunk modules',
    'Burp Suite',
    'splunk-sdk',
    'SplunkWhisperer'
  ]
},

// Bitcoin
{
  id: 'bitcoin',
  name: 'Bitcoin',
  port: '8333',
  category: 'other',
  description: 'Peer-to-peer network for Bitcoin cryptocurrency transactions. ',
  vulnerabilities: [
    'Protocol vulnerabilities',
    'DoS attacks',
    'Eclipse attacks',
    'Information disclosure',
    'Transaction malleability'
  ],
  testing: [
    'Connect to Bitcoin node: `bitcoin-cli -rpcconnect=target.com getnetworkinfo`',
    'Enumerate peers: `bitcoin-cli -rpcconnect=target.com getpeerinfo`',
    'Test RPC access: `curl --data-binary \'{"jsonrpc":"1.0","method":"getnetworkinfo","params":[]}\' http://user:pass@target.com:8333`',
    'Check for unauthenticated access',
    'Test for information disclosure'
  ],
  tools: [
    'bitcoin-cli',
    'curl',
    'Nmap Bitcoin scripts',
    'Metasploit Bitcoin modules',
    'btcscan',
    'BitCoin Vulnerability Scanner'
  ]
},

// FastCGI
{
  id: 'fastcgi',
  name: 'FastCGI',
  port: '9000',
  category: 'web',
  description: 'Protocol for interfacing web servers with web applications. ',
  vulnerabilities: [
    'PHP-FPM code execution',
    'Unauthenticated access',
    'Information disclosure',
    'Path traversal',
    'Remote file inclusion'
  ],
  testing: [
    'Scan for FastCGI: `nmap -p 9000 target.com`',
    'Test for PHP-FPM RCE: `cgi-fcgi -connect target.com:9000 -query /etc/passwd`',
    'Check for path traversal vulnerabilities',
    'Attempt to execute PHP code',
    'Test for information disclosure'
  ],
  tools: [
    'cgi-fcgi',
    'Nmap FastCGI scripts',
    'Metasploit FastCGI modules',
    'php-fpm-exploit',
    'gopherus',
    'fpm-cgi-exploiter'
  ]
},

// HSQLDB
{
  id: 'hsqldb',
  name: 'HSQLDB',
  port: '9001',
  category: 'database',
  description: 'Hypersonic SQL Database, a relational database management system. ',
  vulnerabilities: [
    'Default credentials',
    'Unauthenticated access',
    'Remote code execution',
    'Information disclosure',
    'Weak authentication'
  ],
  testing: [
    'Connect to HSQLDB: `java -cp hsqldb.jar org.hsqldb.util.DatabaseManagerSwing`',
    'Test for default credentials',
    'Check for unauthenticated access',
    'Attempt SQL injection',
    'Test for remote code execution via stored procedures'
  ],
  tools: [
    'hsqldb client tools',
    'Nmap database scripts',
    'Metasploit database modules',
    'sqlmap',
    'HSQLDB Database Manager',
    'DBeaver'
  ]
},

// Raw Printing
{
  id: 'raw_printing',
  name: 'Raw Printing',
  port: '9100',
  category: 'other',
  description: 'Protocol for sending raw data directly to printers, also known as JetDirect or AppSocket. ',
  vulnerabilities: [
    'No authentication',
    'Information disclosure',
    'Print job interception',
    'Printer reconfiguration',
    'Printer firmware modification'
  ],
  testing: [
    'Connect to printer: `nc target.com 9100`',
    'Send test page: `echo "Hello World" | nc target.com 9100`',
    'Extract printer information: `pret target.com raw info`',
    'Test for command injection: `pret target.com raw cmd "id"`',
    'Attempt to access file system: `pret target.com raw fs ls`'
  ],
  tools: [
    'netcat/nc',
    'PRET (Printer Exploitation Toolkit)',
    'Nmap printer scripts',
    'Metasploit printer modules',
    'Praeda',
    'hpjetdirect'
  ]
},

// NDMP
{
  id: 'ndmp',
  name: 'NDMP',
  port: '10000',
  category: 'storage',
  description: 'Network Data Management Protocol used for backup and recovery of data across networks. ',
  vulnerabilities: [
    'Authentication weaknesses',
    'Information disclosure',
    'Default credentials',
    'Remote code execution',
    'Access to backup data'
  ],
  testing: [
    'Scan for NDMP: `nmap -p 10000 target.com`',
    'Test authentication: `python ndmp_check.py target.com`',
    'Check for default credentials',
    'Attempt to list backup sets',
    'Test for information disclosure'
  ],
  tools: [
    'ndmpcopy',
    'ndmp_check.py',
    'Nmap NDMP scripts',
    'Metasploit NDMP modules',
    'ndmpdump',
    'ndmpquery'
  ]
},

// GlusterFS
{
  id: 'glusterfs',
  name: 'GlusterFS',
  port: '24007,24008,24009,49152',
  category: 'storage',
  description: 'Distributed file system capable of scaling to several petabytes. ',
  vulnerabilities: [
    'Unauthenticated access',
    'Remote code execution',
    'Information disclosure',
    'Volume access control issues',
    'Data tampering'
  ],
  testing: [
    'Enumerate GlusterFS: `gluster peer status`',
    'List volumes: `gluster volume list`',
    'Check for unauthenticated access',
    'Attempt to mount volumes: `mount -t glusterfs target.com:/volume /mnt/gluster`',
    'Test for RCE vulnerabilities in older versions'
  ],
  tools: [
    'gluster client',
    'mount.glusterfs',
    'Nmap GlusterFS scripts',
    'Metasploit GlusterFS modules',
    'Custom GlusterFS testing tools'
  ]
},

// Tiller (Helm)
{
  id: 'tiller',
  name: 'Tiller',
  port: '44134',
  category: 'other',
  description: 'Server-side component of Helm, a package manager for Kubernetes. ',
  vulnerabilities: [
    'Unauthenticated access',
    'Lack of TLS',
    'Privilege escalation',
    'Information disclosure',
    'Remote command execution'
  ],
  testing: [
    'Connect to Tiller: `helm --host target.com:44134 ls`',
    'Check authentication: `helm --host target.com:44134 version`',
    'Test for unauthenticated access',
    'Attempt to install malicious charts',
    'Check for information disclosure'
  ],
  tools: [
    'helm client',
    'Nmap scripts',
    'kubernetes-tiller-exploit',
    'tiller-proxy',
    'kubectl'
  ]
},

// EthernetIP
{
  id: 'ethernetip',
  name: 'EthernetIP',
  port: '44818',
  category: 'other',
  description: 'Industrial network protocol for industrial automation control systems. ',
  vulnerabilities: [
    'Lack of authentication',
    'Unencrypted communication',
    'Information disclosure',
    'Remote command execution',
    'PLC reconfiguration'
  ],
  testing: [
    'Scan for EthernetIP: `nmap -p 44818 target.com`',
    'Enumerate devices: `nmap --script enip-info target.com`',
    'List device attributes: `python cpppo-client.py target.com GetAttributeList`',
    'Test for unauthenticated access to PLCs',
    'Attempt to read/write PLC data'
  ],
  tools: [
    'cpppo',
    'EtherNet/IP client',
    'Nmap EthernetIP scripts',
    'Metasploit EthernetIP modules',
    'pycomm',
    'EtherSploit-IP'
  ]
},

// BACNet
{
  id: 'bacnet',
  name: 'BACNet',
  port: '47808',
  category: 'other',
  description: 'Building Automation and Control Networks protocol for building automation systems. ',
  vulnerabilities: [
    'Lack of authentication',
    'Information disclosure',
    'Unencrypted communication',
    'System control vulnerabilities',
    'Device enumeration'
  ],
  testing: [
    'Scan for BACnet: `nmap -sU -p 47808 target.com`',
    'Enumerate devices: `bacnet-discover`',
    'Read device properties: `bacnet-read-property target.com device 8 object-name`',
    'Write to devices: `bacnet-write-property target.com device 8 present-value 100`',
    'Test for unauthenticated system control'
  ],
  tools: [
    'bacnet-tools',
    'Nmap BACnet scripts',
    'Metasploit BACnet modules',
    'BACnet Discovery Tool',
    'BACpypes',
    'Wireshark with BACnet dissector'
  ]
}
        ];

        // --- STATE ---
        const appState = {
            currentFilter: 'all',
            searchTerm: '',
            checkedItems: {},
            currentPage: 1,
            itemsPerPage: 5,
            debug: false, // Keep false for production, true for debugging
            expandedCards: new Set(),
            isMobile: false,
            observer: null
        };

        // --- UTILITIES ---
        function debug(message) { if (appState.debug) console.log(`[DEBUG] ${message}`); }
        const debounce = (func, delay) => { let timeout; return (...args) => { const context = this; clearTimeout(timeout); timeout = setTimeout(() => func.apply(context, args), delay); }; };

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            debug('App initializing...');
            const loadingIndicator = document.getElementById('loadingIndicator');
            if (!loadingIndicator || !document.getElementById('protocolCards') || !document.getElementById('paginationContainer') || !document.getElementById('protocolNav') || !document.getElementById('sidebar') || !document.getElementById('categoryFilters')) {
                 console.error("Initialization failed: Required DOM elements not found.");
                 const body = document.body || document.createElement('body');
                 body.innerHTML = `<div style="color: red; padding: 20px; font-family: sans-serif; text-align: center;">Error: Core UI elements missing. Cannot initialize application.</div>`;
                 return;
            }
             loadingIndicator.style.display = 'flex';
            try {
                updateDeviceState();
                createBackgroundParticles(); // Consider conditional execution based on appState.isMobile
                loadCheckedItems();
                renderSidebarProtocols();
                initializeMainCategoryFilters();
                setupEventListeners();
                initializeAnimations();
                renderProtocolCards();
                setTimeout(updateProgress, 300);
                debug('App initialized.');
             } catch (error) {
                 console.error("Error during initialization steps:", error);
                 loadingIndicator.innerHTML = `<i class='bx bx-error-circle text-4xl text-red-500 mr-2'></i> Error initializing application. Check console.`;
                 loadingIndicator.style.display = 'flex';
             }
        });


        // --- CORE LOGIC ---

        function updateDeviceState() {
             const wasMobile = appState.isMobile;
            appState.isMobile = window.innerWidth < 768;
            if (appState.isMobile) { appState.itemsPerPage = 3; }
            else if (window.innerWidth < 1280) { appState.itemsPerPage = 4; }
            else { appState.itemsPerPage = 5; }
            debug(`Device state: isMobile=${appState.isMobile}, itemsPerPage=${appState.itemsPerPage}`);
            if (document.readyState === 'complete' && wasMobile !== appState.isMobile) {
                 renderProtocolCards();
                 renderSidebarProtocols();
                 // Re-evaluate background particles if disabling on mobile
                 // createBackgroundParticles();
            }
         }

        function loadCheckedItems() {
             try {
                const saved = localStorage.getItem('checkedItems');
                if (saved) { appState.checkedItems = JSON.parse(saved); }
                const testingKeys = Object.keys(appState.checkedItems).filter(key => key.includes('-testing-'));
                debug(`Loaded ${testingKeys.length} checked testing items`);
             } catch (e) { console.error("Error loading checked items:", e); appState.checkedItems = {}; }
         }

        function createBackgroundParticles() {
            // Performance: Skip on mobile if desired
            if (appState.isMobile) {
                debug("Skipping background particles on mobile.");
                return;
            }
            const container = document.getElementById('animatedBg');
            if (!container) return;
            const particleCount = 6; // Reduced default count
            container.innerHTML = '';
            for (let i = 0; i < particleCount; i++) {
                 const size = Math.random() * 80 + 25; // Slightly adjusted range
                 const particle = document.createElement('div'); particle.className = 'floating-particle';
                 particle.style.width = `${size}px`; particle.style.height = `${size}px`; particle.style.left = `${Math.random() * 100}vw`; particle.style.bottom = `-${size}px`;
                 particle.style.animationDuration = `${Math.random() * 25 + 20}s`; particle.style.animationDelay = `${Math.random() * 18}s`; particle.style.setProperty('--x-travel', Math.random() * 0.2 - 0.1);
                 particle.style.background = Math.random() > 0.5 ? 'var(--primary-alpha)' : 'var(--secondary-alpha)'; container.appendChild(particle);
             }
        }

        function getPortDisplay(port) {
             if (port === null || typeof port === 'undefined') return '';
             const portStr = String(port); if (!portStr) return '';
             if (portStr.includes(',') || portStr.includes('-') || portStr.includes(' ')) { return `<span class="port-badge">Ports ${portStr}</span>`; }
             else if (/\d+/.test(portStr)) { return `<span class="port-badge">Port ${portStr}</span>`; }
             return '';
         }

        function renderSidebarProtocols() {
            debug('Rendering sidebar protocol list...');
            const protocolNav = document.getElementById('protocolNav');
            if (!protocolNav) { console.error("Sidebar render failed: Nav container not found."); return; }
            const fragment = document.createDocumentFragment(); // Use DocumentFragment
            const filteredProtocols = getFilteredProtocols();

            if (filteredProtocols.length === 0) { protocolNav.innerHTML = '<p class="text-sm text-neutral-500 px-3">No matching protocols.</p>'; return; }

            const sortedProtocols = [...filteredProtocols].sort((a, b) => (a.name || '').localeCompare(b.name || ''));
             sortedProtocols.forEach((protocol, index) => {
                 if (!protocol || !protocol.id) return;
                 const navItem = document.createElement('div'); navItem.className = 'glass-inset py-3 pr-3 cursor-pointer transition-all duration-300 protocol-nav-item fade-in';
                 navItem.setAttribute('data-protocol-id', protocol.id); navItem.setAttribute('data-category', protocol.category || 'default'); navItem.style.animationDelay = `${index * 0.03}s`;
                 const categoryColor = getCategoryColor(protocol.category); navItem.style.setProperty('--nav-item-color', categoryColor);
                 navItem.innerHTML = `<div class="flex items-center justify-between text-sm"><div class="flex items-center overflow-hidden whitespace-nowrap text-ellipsis"><i class="bx bx-chevron-right mr-1 text-primary flex-shrink-0"></i><span class="overflow-hidden whitespace-nowrap text-ellipsis">${protocol.name || 'Unnamed'}</span></div></div>`;
                 fragment.appendChild(navItem); // Append to fragment
            });
            protocolNav.innerHTML = ''; // Clear only once before appending fragment
            protocolNav.appendChild(fragment); // Append fragment once
            debug(`Sidebar protocol list rendered with ${filteredProtocols.length} items.`);
        }

        function initializeMainCategoryFilters() {
            debug('Initializing main category filters...');
            const categoryFilters = document.getElementById('categoryFilters');
            if (!categoryFilters) { console.error("Category filter initialization failed."); return; }
             const categories = [...new Set(protocolData.map(p => p.category || 'default'))].sort();
             let allCategoryBtn = categoryFilters.querySelector('[data-category="all"]');
             if (!allCategoryBtn) { console.warn("'All' button missing, creating."); allCategoryBtn = document.createElement('button'); allCategoryBtn.className = 'category-filter active'; allCategoryBtn.setAttribute('data-category', 'all'); allCategoryBtn.textContent = 'All'; categoryFilters.insertBefore(allCategoryBtn, categoryFilters.firstChild); }
             else { const existingFilters = categoryFilters.querySelectorAll('.category-filter:not([data-category="all"])'); existingFilters.forEach(btn => btn.remove()); allCategoryBtn.classList.add('active'); }
             allCategoryBtn.style.setProperty('--active-filter-bg', 'var(--primary)');
             categories.forEach(category => { const categoryBtn = document.createElement('button'); categoryBtn.className = 'category-filter'; categoryBtn.setAttribute('data-category', category); categoryBtn.textContent = category.charAt(0).toUpperCase() + category.slice(1); categoryFilters.appendChild(categoryBtn); });
             debug('Main category filters initialized');
        }

        function getFilteredProtocols() {
             try {
                 const lowerSearchTerm = appState.searchTerm.toLowerCase();
                 return protocolData.filter(protocol => {
                     if (!protocol || !protocol.name || !protocol.description) { return false; } // Basic validation
                     const currentCategory = appState.currentFilter === 'all' ? null : appState.currentFilter; const protocolCategory = protocol.category || 'default';
                     const matchesCategory = !currentCategory || protocolCategory === currentCategory;
                     const matchesSearch = !lowerSearchTerm || protocol.name.toLowerCase().includes(lowerSearchTerm) || protocol.description.toLowerCase().includes(lowerSearchTerm) || matchesPort(protocol.port, lowerSearchTerm);
                     return matchesCategory && matchesSearch;
                 });
             } catch (error) { console.error("Error during filtering:", error); return []; }
         }

         function matchesPort(protocolPort, searchTerm) {
             if (protocolPort === null || typeof protocolPort === 'undefined' || !searchTerm) return false;
             const portStr = String(protocolPort).toLowerCase(); const searchStr = String(searchTerm).toLowerCase().trim(); if (!portStr || !searchStr) return false;
             const searchPorts = searchStr.split(',').map(p => p.trim()).filter(p => p !== ''); if (searchPorts.length === 0) return false;
             for (const singleSearchPort of searchPorts) {
                 if (portStr === singleSearchPort) return true;
                 if (portStr.includes(',')) { const protocolPortList = portStr.split(',').map(p => p.trim()); if (protocolPortList.includes(singleSearchPort)) return true; }
                 if (portStr.includes('-')) { const [minPort, maxPort] = portStr.split('-').map(p => parseInt(p.trim(), 10)); if (!isNaN(minPort) && !isNaN(maxPort)) { const searchNum = parseInt(singleSearchPort, 10); if (!isNaN(searchNum) && searchNum >= minPort && searchNum <= maxPort) return true; } }
                 if (singleSearchPort.includes('-')) { const [minSearch, maxSearch] = singleSearchPort.split('-').map(p => parseInt(p.trim(), 10)); if (!isNaN(minSearch) && !isNaN(maxSearch)) { const protocolPortNum = parseInt(portStr, 10); if (!isNaN(protocolPortNum) && protocolPortNum >= minSearch && protocolPortNum <= maxSearch) return true; } }
             }
             return false;
        }

        function renderProtocolCards() {
            const container = document.getElementById('protocolCards'); const pagination = document.getElementById('paginationContainer'); const loadingIndicator = document.getElementById('loadingIndicator');
            if (!container || !pagination || !loadingIndicator) { console.error("Render failed: Elements missing."); return; }
            const currentPageForRender = appState.currentPage; const currentFilterForRender = appState.currentFilter; const currentSearchForRender = appState.searchTerm;
            debug(`renderProtocolCards START: Filter="${currentFilterForRender}", Search="${currentSearchForRender}", Page=${currentPageForRender}`);
            loadingIndicator.style.display = 'flex'; container.innerHTML = ''; pagination.style.display = 'none';

             requestAnimationFrame(() => {
                try {
                    if (appState.observer) appState.observer.disconnect();
                    const fragment = document.createDocumentFragment(); // Use DocumentFragment
                    const filtered = getFilteredProtocols();
                    if (filtered.length === 0) { container.innerHTML = `<div class="no-results section-animate visible col-span-full"><i class="bx bx-search text-4xl mb-2 text-gray-500"></i><h3 class="text-xl font-semibold mb-2">No protocols found</h3><p class="text-gray-400">Try adjusting search or category.</p></div>`; pagination.style.display = 'none'; requestAnimationFrame(() => container.querySelector('.no-results')?.classList.add('visible')); debug('No results found.'); }
                    else {
                        const totalPages = Math.ceil(filtered.length / appState.itemsPerPage); let validatedPage = Math.max(1, Math.min(currentPageForRender, totalPages));
                         if (validatedPage !== currentPageForRender) { debug(`Page validated: ${currentPageForRender} -> ${validatedPage}`); if(appState.currentPage !== validatedPage) { appState.currentPage = validatedPage; debug(`Global page updated to ${validatedPage}`); } }
                        debug(`Render SLICING: Page ${validatedPage}`); const start = (validatedPage - 1) * appState.itemsPerPage; const end = Math.min(start + appState.itemsPerPage, filtered.length); debug(`Slice: ${start}-${end} of ${filtered.length}`);
                        const toRender = filtered.slice(start, end);
                        if (toRender.length === 0 && filtered.length > 0) { console.warn(`Pagination Error: Empty slice.`); container.innerHTML = `<div class="no-results section-animate visible col-span-full"><i class='bx bx-error text-4xl text-yellow-500 mb-2'></i><h3 class="text-xl font-semibold mb-2 text-yellow-400">Pagination Error</h3></div>`; }
                        else {
                            toRender.forEach((protocol, index) => { const card = createProtocolCard(protocol, index); if (card) { fragment.appendChild(card); if (appState.observer) appState.observer.observe(card); } });
                            container.appendChild(fragment); // Append fragment once
                            updatePagination(totalPages);
                         }
                        updateProgress(); requestAnimationFrame(handleScrollAnimations); debug('Cards rendered.');
                    }
                } catch (error) { console.error("Error rendering cards:", error); container.innerHTML = `<div class="no-results section-animate visible col-span-full"><i class='bx bx-error-circle text-4xl text-red-500 mb-2'></i><h3>Error Rendering</h3><p class="text-gray-400">Check console.</p></div>`; pagination.style.display = 'none';
                } finally { loadingIndicator.style.display = 'none'; debug("Loader hidden."); }
             });
        }

        function updatePagination(totalPages) {
             const container = document.getElementById('paginationContainer'); if (!container) return; container.innerHTML = ''; if (totalPages <= 1) { container.style.display = 'none'; return; } container.style.display = 'flex';
             const prevBtn = document.createElement('button'); prevBtn.className = 'pagination-btn'; prevBtn.innerHTML = '<i class="bx bx-chevron-left pointer-events-none"></i>'; prevBtn.disabled = appState.currentPage === 1; prevBtn.setAttribute('aria-label', 'Previous page'); prevBtn.addEventListener('click', () => goToPage(appState.currentPage - 1)); container.appendChild(prevBtn);
             const maxVisible = appState.isMobile ? 3 : 5; let startPage = Math.max(1, appState.currentPage - Math.floor(maxVisible / 2)); let endPage = Math.min(totalPages, startPage + maxVisible - 1); if (endPage - startPage + 1 < maxVisible) { startPage = Math.max(1, endPage - maxVisible + 1); }
             if (startPage > 1) { const firstBtn = document.createElement('button'); firstBtn.className = 'pagination-btn'; firstBtn.textContent = '1'; firstBtn.setAttribute('aria-label', 'Page 1'); firstBtn.addEventListener('click', () => goToPage(1)); container.appendChild(firstBtn); if (startPage > 2) { const ellipsis = document.createElement('span'); ellipsis.className = 'pagination-ellipsis'; ellipsis.textContent = '...'; ellipsis.setAttribute('aria-hidden', 'true'); container.appendChild(ellipsis); } }
             for (let i = startPage; i <= endPage; i++) { const pageBtn = document.createElement('button'); pageBtn.className = `pagination-btn ${i === appState.currentPage ? 'active' : ''}`; pageBtn.textContent = i; pageBtn.setAttribute('aria-label', `Page ${i}`); if (i === appState.currentPage) pageBtn.setAttribute('aria-current', 'page'); pageBtn.addEventListener('click', () => goToPage(i)); container.appendChild(pageBtn); }
             if (endPage < totalPages) { if (endPage < totalPages - 1) { const ellipsis = document.createElement('span'); ellipsis.className = 'pagination-ellipsis'; ellipsis.textContent = '...'; ellipsis.setAttribute('aria-hidden', 'true'); container.appendChild(ellipsis); } const lastBtn = document.createElement('button'); lastBtn.className = 'pagination-btn'; lastBtn.textContent = totalPages; lastBtn.setAttribute('aria-label', `Page ${totalPages}`); lastBtn.addEventListener('click', () => goToPage(totalPages)); container.appendChild(lastBtn); }
             const nextBtn = document.createElement('button'); nextBtn.className = 'pagination-btn'; nextBtn.innerHTML = '<i class="bx bx-chevron-right pointer-events-none"></i>'; nextBtn.disabled = appState.currentPage === totalPages; nextBtn.setAttribute('aria-label', 'Next page'); nextBtn.addEventListener('click', () => goToPage(appState.currentPage + 1)); container.appendChild(nextBtn);
         }

        function goToPage(page) {
            debug(`goToPage called: req=${page}, current=${appState.currentPage}`); if (page < 1 || page === appState.currentPage) { return; }
            const filtered = getFilteredProtocols(); const totalPages = Math.ceil(filtered.length / appState.itemsPerPage);
            if (page > totalPages && totalPages > 0) { page = totalPages; } else if (page < 1) { page = 1; }
            if (page === appState.currentPage) { return; }
            appState.currentPage = page; debug(`appState.currentPage updated: ${appState.currentPage}`); renderProtocolCards();
            const mainContent = document.getElementById('mainContent'); if (mainContent) { mainContent.scrollIntoView({ behavior: 'smooth', block: 'start' }); } else { window.scrollTo({ top: 0, behavior: 'smooth' }); }
        }

        function generateListItems(items, type, protocolId) {
              if (!items || items.length === 0) return '<li class="text-gray-500 text-sm list-item-no-checkbox">None listed.</li>';
              const includeCheckbox = (type === 'testing');
              return items.map((item, i) => {
                  if (typeof item !== 'string') return ''; const key = `${protocolId}-${type}-${i}`; const isChecked = includeCheckbox && appState.checkedItems[key];
                  const processedItem = item.replace(/`([^`]+)`/g, (match, codeContent) => { const escapedCode = codeContent.replace(/</g, "<").replace(/>/g, ">"); return `<code class="command-inline">${escapedCode}</code>`; });
                  let listItemHTML = `<li class="flex items-start list-item-animate ${!includeCheckbox ? 'list-item-no-checkbox-container' : ''}">`;
                  if (includeCheckbox) { listItemHTML += `<label class="toggle-container inline-flex mr-3 mt-0.5 flex-shrink-0"><input type="checkbox" class="toggle-input ${type}-check" data-protocol="${protocolId}" data-type="${type}" data-index="${i}" ${isChecked ? 'checked' : ''}><span class="toggle-slider"></span></label><span class="checkmark-animate text-sm flex-grow ${isChecked ? 'line-through text-gray-500' : ''}">${processedItem}</span>`; }
                  else { listItemHTML += `<span class="text-sm flex-grow list-item-no-checkbox">${processedItem}</span>`; }
                  listItemHTML += `</li>`; return listItemHTML;
              }).join('');
          }

        function createProtocolCard(protocol, indexOnPage) {
             try {
                 if (!protocol || !protocol.id || !protocol.name) { console.warn("Skipping card: invalid data:", protocol); return null; }
                 const card = document.createElement('div'); card.className = 'protocol-card glass-card section-animate relative'; card.id = protocol.id;
                 const categoryColor = getCategoryColor(protocol.category); const totalItems = protocol.testing?.length || 0; let checkedCount = 0;
                 if (protocol.testing) { protocol.testing.forEach((_, i) => { if (appState.checkedItems[`${protocol.id}-testing-${i}`]) { checkedCount++; } }); }
                 const percentage = totalItems > 0 ? Math.round((checkedCount / totalItems) * 100) : 0; let portDisplayHtml = getPortDisplay(protocol.port); const isExpanded = appState.expandedCards.has(protocol.id);
                 const vulnerabilitiesList = generateListItems(protocol.vulnerabilities, 'vulnerability', protocol.id); const testingList = generateListItems(protocol.testing, 'testing', protocol.id); const toolsList = generateListItems(protocol.tools, 'tool', protocol.id);
                 card.innerHTML = `<div class="category-indicator" style="background: ${categoryColor}"></div> <div class="card-header p-4 md:p-6 flex flex-col md:flex-row md:items-center justify-between" data-id="${protocol.id}"> <div class="flex-grow mb-3 md:mb-0 md:mr-4"><div class="flex items-center mb-1 flex-wrap"><h2 class="text-xl md:text-2xl font-bold mr-3">${protocol.name}</h2>${portDisplayHtml}<span class="category-badge ml-3 mt-1 md:mt-0" style="background: ${categoryColor};">${protocol.category || 'other'}</span></div><p class="text-gray-400 text-sm">${protocol.description || ''}</p></div> <div class="flex items-center justify-between md:justify-start flex-shrink-0"><div class="mr-4 relative text-center md:text-left"><div class="text-xs text-gray-400 mb-1">Testing Progress</div><div class="progress-container w-24 md:w-32"><div class="progress-bar" data-protocol="${protocol.id}" style="width: ${percentage}%"></div><div class="completion-percentage">${percentage}%</div></div></div><button class="expand-btn bg-gray-800 hover:bg-gray-700 p-2 rounded-full transition-all duration-300" aria-expanded="${isExpanded}"><i class="bx bx-chevron-down text-2xl transition-transform duration-300 ${isExpanded ? 'transform rotate-180' : ''}"></i></button></div> </div> <div class="card-content"><div class="grid grid-cols-1 lg:grid-cols-3 gap-4 md:gap-6 pt-2 md:pt-4"><div class="glass-inset p-4 content-section"><h3 class="text-base md:text-lg font-semibold mb-3 flex items-center"><i class="bx bx-shield-quarter text-red-500 mr-2"></i> Vulnerabilities</h3><ul class="space-y-2">${vulnerabilitiesList}</ul></div><div class="glass-inset p-4 content-section"><h3 class="text-base md:text-lg font-semibold mb-3 flex items-center"><i class="bx bx-test-tube text-yellow-500 mr-2"></i> Testing</h3><ul class="space-y-2">${testingList}</ul></div><div class="glass-inset p-4 content-section"><h3 class="text-base md:text-lg font-semibold mb-3 flex items-center"><i class="bx bx-wrench text-blue-500 mr-2"></i> Tools</h3><ul class="space-y-2">${toolsList}</ul></div></div></div>`;
                 if (isExpanded) { card.classList.add('expanded'); const content = card.querySelector('.card-content'); if (content) { const originalTransition = content.style.transition; content.style.transition = 'none'; content.style.maxHeight = '2000px'; content.style.opacity = '1'; content.style.visibility = 'visible'; content.style.transform = 'translateY(0)'; content.style.paddingTop = '1rem'; content.style.paddingBottom = '20px'; card.querySelectorAll('.content-section, .list-item-animate').forEach(el => { const originalItemTransition = el.style.transition; el.style.transition = 'none'; el.style.opacity = '1'; el.style.transform = 'translate(0, 0)'; requestAnimationFrame(() => { el.style.transition = originalItemTransition; }); }); requestAnimationFrame(() => { content.style.transition = originalTransition; }); } }
                 return card;
             } catch (error) { console.error(`Error creating card for ${protocol?.id}:`, error); return null; }
          }

        function filterByCategory(category) {
            debug(`Filtering category: "${category}"`); if (appState.currentFilter === category) return;
            appState.currentFilter = category; appState.currentPage = 1;
            document.querySelectorAll('#categoryFilters .category-filter').forEach(btn => {
                const btnCategory = btn.getAttribute('data-category'); const isActive = (btnCategory === category); btn.classList.toggle('active', isActive);
                if (isActive) { const activeColor = (category === 'all') ? 'var(--primary)' : getCategoryColor(category); btn.style.setProperty('--active-filter-bg', activeColor); debug(`Set active color for filter '${category}': ${activeColor}`); }
            });
            renderProtocolCards(); renderSidebarProtocols();
        }

        function setupEventListeners() {
            debug('Setting up listeners...'); const sidebar = document.getElementById('sidebar'); const mainContent = document.getElementById('mainContent'); const categoryFilters = document.getElementById('categoryFilters');
            document.getElementById('menuToggle')?.addEventListener('click', () => sidebar?.classList.add('open'));
            document.getElementById('mobileClose')?.addEventListener('click', () => sidebar?.classList.remove('open'));
            mainContent?.addEventListener('click', (e) => { if (appState.isMobile && sidebar?.classList.contains('open') && !sidebar.contains(e.target) && !e.target.closest('#menuToggle')) { sidebar.classList.remove('open'); } });
            document.getElementById('search')?.addEventListener('input', debounce((e) => { appState.searchTerm = e.target.value.trim(); appState.currentPage = 1; renderProtocolCards(); renderSidebarProtocols(); }, 300));
            document.getElementById('protocolCards')?.addEventListener('click', (e) => { const trigger = e.target.closest('.card-header, .expand-btn'); if (trigger) { const card = trigger.closest('.protocol-card'); if (card) { toggleCardExpansion(card); } } });
            document.getElementById('protocolCards')?.addEventListener('change', (e) => { if (e.target.classList.contains('toggle-input') && e.target.type === 'checkbox') { handleCheckboxChange(e.target); } });
            categoryFilters?.addEventListener('click', (e) => { const btn = e.target.closest('.category-filter'); if (btn && !btn.classList.contains('active')) { filterByCategory(btn.getAttribute('data-category')); } });
            document.getElementById('protocolNav')?.addEventListener('click', (e) => { const item = e.target.closest('[data-protocol-id]'); if (item) { const id = item.getAttribute('data-protocol-id'); scrollToProtocol(id); if (appState.isMobile) { sidebar?.classList.remove('open'); } } });
            window.addEventListener('resize', debounce(updateDeviceState, 250));
            document.addEventListener('keydown', (e) => { const paginationContainer = document.getElementById('paginationContainer'); if (!paginationContainer || paginationContainer.style.display === 'none') return; if (e.key === 'ArrowLeft') { const btn = paginationContainer.querySelector('button:first-child:not(:disabled)'); if (btn) goToPage(appState.currentPage - 1); } else if (e.key === 'ArrowRight') { const btn = paginationContainer.querySelector('button:last-child:not(:disabled)'); if (btn) goToPage(appState.currentPage + 1); } });
            debug('Listeners setup complete');
        }

        function handleCheckboxChange(checkbox) {
              const protocol = checkbox.getAttribute('data-protocol'); const type = checkbox.getAttribute('data-type'); const index = checkbox.getAttribute('data-index'); const key = `${protocol}-${type}-${index}`; const isChecked = checkbox.checked;
              appState.checkedItems[key] = isChecked; debug(`Checkbox changed: ${key} = ${isChecked}`);
              try { localStorage.setItem('checkedItems', JSON.stringify(appState.checkedItems)); } catch (e) { console.error("Error saving items:", e); }
              const textElement = checkbox.closest('li')?.querySelector('span.checkmark-animate'); if (textElement) { textElement.classList.toggle('line-through', isChecked); textElement.classList.toggle('text-gray-500', isChecked); }
              updateProgressForCard(protocol);
          }

        function updateProgressForCard(protocolId) {
              const protocol = protocolData.find(p => p && p.id === protocolId); if (!protocol) return;
              const totalItems = protocol.testing?.length || 0; const cardElement = document.getElementById(protocolId); if (!cardElement) return;
              const bar = cardElement.querySelector(`.progress-bar[data-protocol="${protocolId}"]`); const text = cardElement.querySelector('.completion-percentage');
              if (totalItems === 0) { if (bar) bar.style.width = '0%'; if (text) text.textContent = '0%'; return; }
              let checkedCount = 0; if (protocol.testing) { protocol.testing.forEach((_, i) => { if (appState.checkedItems[`${protocol.id}-testing-${i}`]) { checkedCount++; } }); }
              const percentage = Math.round((checkedCount / totalItems) * 100);
              if (bar) { animateElement(bar, [{ width: bar.style.width || '0%' }, { width: `${percentage}%` }], { duration: 600, easing: 'cubic-bezier(0.22, 1, 0.36, 1)', fill: 'forwards' }); }
              if (text) { text.textContent = `${percentage}%`; }
          }

        function updateProgress() {
              debug('Updating progress bars'); const visibleCards = document.querySelectorAll('#protocolCards .protocol-card'); visibleCards.forEach(card => { if (card.id) { updateProgressForCard(card.id); } });
          }

        function animateElement(element, keyframes, options) {
              if (!element || typeof element.animate !== 'function') { if (element && keyframes.length > 0) Object.assign(element.style, keyframes[keyframes.length - 1]); return { finished: Promise.resolve() }; }
              const effectiveOptions = { ...options }; if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) { effectiveOptions.duration = (options.duration || 300) * 0.1; effectiveOptions.delay = (options.delay || 0) * 0.1; }
              try { return element.animate(keyframes, effectiveOptions); } catch (e) { console.error("Animation error:", e, element); if (element && keyframes.length > 0) Object.assign(element.style, keyframes[keyframes.length - 1]); return { finished: Promise.resolve() }; }
          }

        function toggleCardExpansion(card) {
               if (!card) return; const content = card.querySelector('.card-content'); const icon = card.querySelector('.expand-btn i'); const button = card.querySelector('.expand-btn'); const id = card.id; if (!content || !icon || !button) return; const wasExpanded = card.classList.contains('expanded'); debug(`Toggling card: ${id} (was expanded: ${wasExpanded})`); if (wasExpanded) { appState.expandedCards.delete(id); } else { appState.expandedCards.add(id); } button.setAttribute('aria-expanded', !wasExpanded);
               if (wasExpanded) { card.classList.remove('expanded'); card.querySelectorAll('.content-section').forEach((s) => animateElement(s, [{ opacity: 1, transform: 'translateY(0)' }, { opacity: 0, transform: 'translateY(10px)' }], { duration: 150, easing: 'ease-out', fill: 'forwards' })); card.querySelectorAll('.list-item-animate').forEach(item => item.style.opacity = 0); const anim = animateElement(content, [{ height: content.scrollHeight + 'px', opacity: 1, transform: 'translateY(0)', paddingBottom: '20px', paddingTop: '1rem' }, { height: '0px', opacity: 0, transform: 'translateY(10px)', paddingBottom: '0px', paddingTop: '0px'}], { duration: 350, easing: 'cubic-bezier(0.4, 0, 0.2, 1)', fill: 'forwards' }); animateElement(icon, [{ transform: 'rotate(180deg)' }, { transform: 'rotate(0deg)' }], { duration: 300, easing: 'ease-out', fill: 'forwards' }); anim.finished.catch(e => console.warn("Collapse animation interrupted", e)); }
               else { card.classList.add('expanded'); content.style.height = '0px'; content.style.opacity = '0'; content.style.paddingTop = '0px'; content.style.paddingBottom = '0px'; const anim = animateElement(content, [{ height: '0px', opacity: 0, transform: 'translateY(10px)', paddingBottom: '0px', paddingTop: '0px' }, { height: content.scrollHeight + 'px', opacity: 1, transform: 'translateY(0)', paddingBottom: '20px', paddingTop: '1rem' }], { duration: 400, easing: 'cubic-bezier(0.2, 0, 0.1, 1)', fill: 'forwards' }); animateElement(icon, [{ transform: 'rotate(0deg)' }, { transform: 'rotate(180deg)' }], { duration: 350, easing: 'ease-in-out', fill: 'forwards' }); anim.finished.then(() => { if (!appState.expandedCards.has(id)) return; card.querySelectorAll('.content-section').forEach((s, i) => animateElement(s, [{ opacity: 0, transform: 'translateY(15px)' }, { opacity: 1, transform: 'translateY(0)' }], { duration: 300, easing: 'ease-out', fill: 'forwards', delay: 50 + i * 75 })); card.querySelectorAll('.list-item-animate').forEach((item, i) => animateElement(item, [{ opacity: 0, transform: 'translateX(15px)' }, { opacity: 1, transform: 'translateX(0)' }], { duration: 300, easing: 'ease-out', fill: 'forwards', delay: 150 + i * 30 })); }).catch(e => { console.warn("Expand animation interrupted", e); if (appState.expandedCards.has(id)) { content.style.height = ''; content.style.opacity = '1'; content.style.transform = 'translateY(0)'; content.style.paddingBottom = '20px'; content.style.paddingTop = '1rem'; card.querySelectorAll('.content-section, .list-item-animate').forEach(el => { el.style.opacity = '1'; el.style.transform = 'translate(0, 0)'; }); } else { card.classList.remove('expanded'); } }); }
           }

        function initializeAnimations() {
              debug('Initializing Intersection Observer'); const options = { root: null, rootMargin: '0px', threshold: 0.1 }; if (appState.observer) appState.observer.disconnect(); appState.observer = new IntersectionObserver((entries) => { entries.forEach(entry => { if (entry.isIntersecting) { entry.target.classList.add('visible'); } }); }, options); requestAnimationFrame(handleScrollAnimations);
          }

        function handleScrollAnimations() {
              const elements = document.querySelectorAll('.section-animate:not(.visible)'); if (!appState.observer) return; elements.forEach(element => { const rect = element.getBoundingClientRect(); if (rect.top < window.innerHeight && rect.bottom > 0) { appState.observer.observe(element); } });
          }

        // --- DYNAMIC COLOR GENERATION ---
        const categoryColorCache = {};
        const GOLDEN_ANGLE_RATIO = 0.61803398875;
        function generateHslColorFromString(str) {
            const baseSaturation = 75; const baseLightness = 55; const lightnessVariation = 15; const saturationVariation = 15; // Increased variation
            let hash = 0; if (!str || str.length === 0) { hash = 0; } else { for (let i = 0; i < str.length; i++) { const char = str.charCodeAt(i); hash = ((hash << 5) - hash) + char; hash |= 0; } } const absHash = Math.abs(hash);
            let hue = Math.floor(((absHash * GOLDEN_ANGLE_RATIO) % 1) * 360); const pinkMinHue = 290; const pinkMaxHue = 350; const hueShiftAmount = 60; if (hue >= pinkMinHue && hue <= pinkMaxHue) { hue = (hue + hueShiftAmount) % 360; }
            const saturationOffset = (absHash % (saturationVariation * 2)) - saturationVariation; const saturation = Math.max(50, Math.min(95, baseSaturation + saturationOffset)); // Wider S range
            const lightnessOffset = (Math.floor(absHash / 13) % (lightnessVariation * 2)) - lightnessVariation; const lightness = Math.max(45, Math.min(75, baseLightness + lightnessOffset)); // Wider L range
            const lightnessDarker = Math.max(25, lightness - 20); // Ensure decent gradient diff
            return { hue, saturation, lightness, lightnessDarker };
        }
        function getCategoryColor(category) {
            const categoryKey = (category && typeof category === 'string' && category.trim() !== '') ? category.toLowerCase() : 'uncategorized';
            if (categoryColorCache[categoryKey]) { return categoryColorCache[categoryKey]; } const hsl = generateHslColorFromString(categoryKey);
            const colorGradient = `linear-gradient(135deg, hsl(${hsl.hue}, ${hsl.saturation}%, ${hsl.lightness}%) 0%, hsl(${hsl.hue}, ${hsl.saturation}%, ${hsl.lightnessDarker}%) 100%)`;
            categoryColorCache[categoryKey] = colorGradient; return colorGradient;
         }
        // --- END DYNAMIC COLOR GENERATION ---

        // --- SCROLL/HIGHLIGHT/EXPAND LOGIC ---
        function scrollToProtocol(id) {
             const protocol = protocolData.find(p => p && p.id === id); if (!protocol) { debug(`Protocol not found for scroll: ${id}`); return; }
             if (appState.currentFilter !== 'all' && protocol.category !== appState.currentFilter) { debug(`Switching filter to '${protocol.category}' for scrolling to ${id}`); filterByCategory(protocol.category); setTimeout(() => findAndScrollToProtocol(id), 200); return; }
             findAndScrollToProtocol(id);
         }
        function findAndScrollToProtocol(id) {
             const filtered = getFilteredProtocols(); const index = filtered.findIndex(p => p && p.id === id);
             if (index === -1) { debug(`Protocol ${id} not found in current results.`); return; }
             const targetPage = Math.floor(index / appState.itemsPerPage) + 1;
             if (targetPage !== appState.currentPage) { debug(`Navigating to page ${targetPage} for ${id}`); appState.currentPage = targetPage; renderProtocolCards(); renderSidebarProtocols(); setTimeout(() => scrollAndHighlight(id), 300); }
             else { scrollAndHighlight(id); }
         }
        function scrollAndHighlight(id) {
             requestAnimationFrame(() => {
                 const element = document.getElementById(id);
                 if (!element) { setTimeout(() => { const elementRetry = document.getElementById(id); if (!elementRetry) { debug(`Element ${id} not found.`); return; } performScrollAndHighlight(elementRetry); }, 150); return; }
                 performScrollAndHighlight(element);
            });
        }
        function performScrollAndHighlight(element) {
            const id = element.id; debug(`Scrolling & Highlighting: ${id}`);
            element.scrollIntoView({ behavior: 'smooth', block: 'center' });
             setTimeout(() => {
                  if (!document.getElementById(id)) return;
                  if (!element.classList.contains('expanded')) { toggleCardExpansion(element); }
                  const originalShadow = element.style.boxShadow; element.style.transition = 'box-shadow 0.3s ease-in-out';
                  element.style.boxShadow = `0 0 30px rgba(139, 92, 246, 0.6), ${originalShadow || ''}`;
                  setTimeout(() => { element.style.boxShadow = originalShadow || ''; setTimeout(() => element.style.transition = '', 300); }, 1500);
             }, 400);
         }
        // --- END SCROLL/HIGHLIGHT/EXPAND LOGIC ---

    </script>
</body>
</html>
